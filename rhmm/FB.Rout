
R version 3.0.2 (2013-09-25) -- "Frisbee Sailing"
Copyright (C) 2013 The R Foundation for Statistical Computing
Platform: x86_64-redhat-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> require(devEMF)
Loading required package: devEMF
> library(quantmod)
Loading required package: Defaults
Loading required package: xts
Loading required package: zoo

Attaching package: ‘zoo’

The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric

Loading required package: TTR
Version 0.4-0 included new data defaults. See ?getSymbols.
> library(RHmm)
Loading required package: MASS
Loading required package: nlme
> library(parallel)
> #postscript('FB.eps')
> 
> getSymbols("FB", src = "google")
    As of 0.4-0, ‘getSymbols’ uses env=parent.frame() and
 auto.assign=TRUE by default.

 This  behavior  will be  phased out in 0.5-0  when the call  will
 default to use auto.assign=FALSE. getOption("getSymbols.env") and 
 getOptions("getSymbols.auto.assign") are now checked for alternate defaults

 This message is shown once per session and may be disabled by setting 
 options("getSymbols.warning4.0"=FALSE). See ?getSymbol for more details
[1] "FB"
> #getSymbols("FB")
> chartSeries(FB, theme="white")
> #trainset <- window(FB, start = as.Date("2000-01-01"), end = as.Date("2013-04-01"))
> trainsetraw <- window(FB, start = as.Date("2000-01-01"), end = as.Date("2013-04-01"))
> print(ncol(trainsetraw)-1)
[1] 4
> print(trainsetraw[,1:ncol(trainsetraw)-1])
           FB.Open FB.High FB.Low FB.Close
2012-05-17      NA      NA     NA    38.00
2012-05-18   42.05   45.00  38.00    38.23
2012-05-21   36.53   36.66  33.00    34.03
2012-05-22   32.61   33.59  30.94    31.00
2012-05-23   31.37   32.50  31.36    32.00
2012-05-24   32.95   33.21  31.77    33.03
2012-05-25   32.90   32.95  31.11    31.91
2012-05-29   31.48   31.69  28.65    28.84
2012-05-30   28.70   29.55  27.86    28.19
2012-05-31   28.54   29.67  26.83    29.60
2012-06-01   28.89   29.15  27.39    27.72
2012-06-04   27.20   27.65  26.44    26.90
2012-06-05   26.70   27.76  25.75    25.87
2012-06-06   26.07   27.17  25.52    26.81
2012-06-07   27.00   27.35  26.15    26.31
2012-06-08   26.55   27.76  26.44    27.10
2012-06-11   27.18   28.07  26.84    27.00
2012-06-12   27.48   27.77  26.96    27.40
2012-06-13   27.66   28.10  27.10    27.27
2012-06-14   27.65   28.32  27.38    28.29
2012-06-15   28.50   30.10  28.35    30.01
2012-06-18   29.96   32.08  29.41    31.41
2012-06-19   31.54   32.18  30.70    31.91
2012-06-20   31.92   31.93  31.15    31.60
2012-06-21   31.67   32.50  31.51    31.84
2012-06-22   32.41   33.45  32.06    33.05
2012-06-25   32.86   33.02  31.55    32.06
2012-06-26   32.69   33.44  32.50    33.10
2012-06-27   32.46   32.90  31.90    32.23
2012-06-28   31.96   32.19  30.90    31.36
2012-06-29   31.92   31.99  30.76    31.10
2012-07-02   31.25   31.73  30.55    30.77
2012-07-03   30.91   31.44  30.80    31.20
2012-07-05   31.32   31.62  31.02    31.47
2012-07-06   31.44   31.90  31.26    31.73
2012-07-09   32.10   32.88  31.99    32.17
2012-07-10   32.43   32.48  31.16    31.47
2012-07-11   31.48   31.56  30.55    30.97
2012-07-12   30.70   31.40  30.60    30.81
2012-07-13   31.04   31.07  30.56    30.72
2012-07-16   30.50   30.50  28.21    28.24
2012-07-17   28.48   28.59  27.15    28.09
2012-07-18   28.31   29.29  28.15    29.11
2012-07-19   29.41   29.50  28.63    29.00
2012-07-20   29.00   29.47  28.72    28.76
2012-07-23   28.12   29.00  28.01    28.75
2012-07-24   28.82   29.45  28.10    28.45
2012-07-25   28.39   29.49  28.08    29.34
2012-07-26   27.75   28.23  26.73    26.84
2012-07-27   23.19   24.54  22.28    23.70
2012-07-30   24.00   24.04  23.03    23.15
2012-07-31   23.37   23.37  21.61    21.71
2012-08-01   21.50   21.58  20.84    20.88
2012-08-02   20.77   20.84  19.82    20.04
2012-08-03   20.36   22.16  19.90    21.09
2012-08-06   21.39   22.15  21.30    21.92
2012-08-07   22.20   22.45  20.50    20.72
2012-08-08   20.71   21.15  20.22    20.72
2012-08-09   20.75   21.17  20.61    21.01
2012-08-10   21.41   21.82  21.13    21.81
2012-08-13   22.15   22.45  21.40    21.60
2012-08-14   21.41   21.60  20.25    20.38
2012-08-15   20.64   21.41  20.40    21.20
2012-08-16   20.44   20.48  19.69    19.87
2012-08-17   20.00   20.08  19.00    19.05
2012-08-20   19.05   20.13  18.75    20.01
2012-08-21   19.58   19.98  19.09    19.16
2012-08-22   19.36   19.53  18.96    19.44
2012-08-23   19.50   19.73  19.36    19.44
2012-08-24   19.52   19.68  19.25    19.41
2012-08-27   19.49   19.53  19.10    19.15
2012-08-28   19.10   19.38  18.95    19.34
2012-08-29   19.32   19.38  19.07    19.10
2012-08-30   19.27   19.45  19.06    19.09
2012-08-31   18.68   18.70  18.03    18.06
2012-09-04   18.08   18.27  17.55    17.73
2012-09-05   18.27   18.75  18.18    18.58
2012-09-06   18.74   19.26  18.72    18.96
2012-09-07   19.10   19.42  18.78    18.98
2012-09-10   19.06   19.20  18.55    18.81
2012-09-11   18.92   19.58  18.85    19.43
2012-09-12   20.76   21.16  20.28    20.93
2012-09-13   20.96   21.48  20.61    20.71
2012-09-14   21.13   22.08  20.90    22.00
2012-09-17   22.67   22.75  21.50    21.52
2012-09-18   21.60   21.98  21.37    21.87
2012-09-19   21.99   23.37  21.77    23.29
2012-09-20   23.02   23.24  22.54    22.59
2012-09-21   22.97   23.24  22.60    22.86
2012-09-24   21.77   21.98  20.36    20.79
2012-09-25   21.20   21.21  20.22    20.28
2012-09-26   20.14   20.78  19.80    20.62
2012-09-27   20.99   21.00  20.16    20.32
2012-09-28   20.57   21.95  20.50    21.66
2012-10-01   22.08   22.59  21.73    21.99
2012-10-02   22.08   22.49  21.82    22.27
2012-10-03   22.30   22.49  21.80    21.83
2012-10-04   22.32   22.40  21.41    21.95
2012-10-05   21.49   21.63  20.88    20.91
2012-10-08   20.62   20.75  20.16    20.40
2012-10-09   20.39   20.55  19.97    20.23
2012-10-10   19.93   19.94  19.45    19.64
2012-10-11   19.88   19.96  19.61    19.75
2012-10-12   19.75   19.80  19.48    19.52
2012-10-15   19.68   19.88  19.49    19.52
2012-10-16   19.68   19.69  19.30    19.48
2012-10-17   19.50   20.48  19.37    19.88
2012-10-18   19.70   19.79  18.89    18.98
2012-10-19   19.00   19.06  18.80    19.00
2012-10-22   19.20   19.43  19.05    19.32
2012-10-23   19.25   19.80  19.10    19.50
2012-10-24   24.13   24.25  22.85    23.23
2012-10-25   23.29   23.31  22.47    22.56
2012-10-26   22.40   22.88  21.88    21.94
2012-10-31   20.82   21.50  20.73    21.11
2012-11-01   21.08   21.44  21.01    21.21
2012-11-02   21.26   21.69  21.07    21.18
2012-11-05   21.10   21.48  20.92    21.25
2012-11-06   21.24   21.37  20.99    21.17
2012-11-07   20.85   20.95  20.37    20.47
2012-11-08   20.52   20.73  19.98    19.99
2012-11-09   19.96   20.00  19.13    19.21
2012-11-12   19.15   20.17  18.87    20.07
2012-11-13   19.60   20.11  19.56    19.86
2012-11-14   20.10   22.50  19.93    22.36
2012-11-15   22.34   22.50  21.65    22.17
2012-11-16   22.25   23.93  22.18    23.56
2012-11-19   23.96   24.12  22.82    22.92
2012-11-20   22.73   23.90  22.70    23.10
2012-11-21   23.22   24.53  23.05    24.32
2012-11-23   24.58   24.68  23.88    24.00
2012-11-26   24.94   26.09  24.81    25.94
2012-11-27   26.04   26.50  25.46    26.15
2012-11-28   25.94   26.49  25.75    26.36
2012-11-29   26.50   27.52  26.16    27.32
2012-11-30   27.26   28.00  26.76    28.00
2012-12-03   28.00   28.88  26.98    27.04
2012-12-04   27.06   27.76  26.68    27.46
2012-12-05   27.75   27.90  27.26    27.71
2012-12-06   27.68   27.75  26.82    26.97
2012-12-07   27.07   27.78  26.84    27.48
2012-12-10   27.17   28.17  27.10    27.84
2012-12-11   28.07   28.24  27.66    27.98
2012-12-12   28.00   28.14  27.37    27.58
2012-12-13   27.59   28.75  27.43    28.24
2012-12-14   28.18   28.33  26.76    26.81
2012-12-17   26.77   27.00  26.32    26.75
2012-12-18   26.96   27.91  26.90    27.71
2012-12-19   27.83   28.22  26.95    27.41
2012-12-20   27.49   27.60  27.13    27.36
2012-12-21   26.66   27.01  26.12    26.26
2012-12-24   26.50   26.96  26.20    26.93
2012-12-26   27.03   27.18  26.38    26.51
2012-12-27   26.55   26.80  25.52    26.05
2012-12-28   25.48   26.11  25.15    25.91
2012-12-31   26.20   26.99  26.11    26.62
2013-01-02   27.44   28.18  27.42    28.00
2013-01-03   27.88   28.47  27.59    27.77
2013-01-04   28.01   28.93  27.83    28.76
2013-01-07   28.69   29.79  28.65    29.42
2013-01-08   29.51   29.60  28.86    29.06
2013-01-09   29.67   30.60  29.49    30.59
2013-01-10   30.60   31.45  30.28    31.30
2013-01-11   31.28   31.96  31.10    31.72
2013-01-14   32.08   32.21  30.62    30.95
2013-01-15   30.64   31.71  29.88    30.10
2013-01-16   30.21   30.35  29.53    29.85
2013-01-17   30.08   30.42  30.03    30.14
2013-01-18   30.31   30.44  29.27    29.66
2013-01-22   29.75   30.89  29.74    30.73
2013-01-23   31.10   31.50  30.80    30.82
2013-01-24   31.27   31.49  30.81    31.08
2013-01-25   31.41   31.93  31.13    31.54
2013-01-28   31.88   32.51  31.81    32.47
2013-01-29   32.00   32.07  30.71    30.79
2013-01-30   30.98   31.49  30.88    31.24
2013-01-31   29.15   31.47  28.74    30.98
2013-02-01   31.01   31.02  29.63    29.73
2013-02-04   29.06   29.20  28.01    28.11
2013-02-05   28.26   28.96  28.04    28.64
2013-02-06   28.74   29.29  28.66    29.05
2013-02-07   29.11   29.15  28.27    28.65
2013-02-08   28.89   29.17  28.51    28.54
2013-02-11   28.61   28.68  28.04    28.26
2013-02-12   27.67   28.16  27.10    27.37
2013-02-13   27.36   28.32  27.31    27.91
2013-02-14   28.02   28.63  28.01    28.50
2013-02-15   28.52   28.75  28.09    28.32
2013-02-19   28.23   29.08  28.12    28.93
2013-02-20   28.92   29.05  28.33    28.46
2013-02-21   28.28   28.55  27.15    27.28
2013-02-22   27.62   27.63  26.82    27.13
2013-02-25   27.16   27.64  27.15    27.27
2013-02-26   27.36   27.46  26.70    27.39
2013-02-27   27.34   27.34  26.63    26.87
2013-02-28   26.84   27.30  26.34    27.25
2013-03-01   27.05   28.12  26.81    27.78
2013-03-04   27.76   28.06  27.44    27.72
2013-03-05   27.88   28.18  27.21    27.52
2013-03-06   28.10   28.13  27.35    27.45
2013-03-07   27.57   28.68  27.47    28.58
2013-03-08   28.42   28.47  27.73    27.96
2013-03-11   28.01   28.64  27.83    28.14
2013-03-12   28.10   28.32  27.60    27.83
2013-03-13   27.62   27.65  26.92    27.08
2013-03-14   27.10   27.43  26.83    27.04
2013-03-15   27.03   27.06  26.56    26.64
2013-03-18   26.37   26.79  25.78    26.49
2013-03-19   26.53   26.90  26.21    26.55
2013-03-20   26.68   26.69  25.78    25.86
2013-03-21   25.66   26.11  25.56    25.74
2013-03-22   25.80   26.01  25.63    25.73
2013-03-25   25.75   25.80  25.08    25.13
2013-03-26   25.08   25.48  25.03    25.20
2013-03-27   25.00   26.28  24.72    26.09
2013-03-28   26.09   26.17  25.52    25.58
2013-04-01   25.63   25.89  25.28    25.53
> trainset <- na.omit(trainsetraw[,1:ncol(trainsetraw)-1])
> print(trainset)
           FB.Open FB.High FB.Low FB.Close
2012-05-18   42.05   45.00  38.00    38.23
2012-05-21   36.53   36.66  33.00    34.03
2012-05-22   32.61   33.59  30.94    31.00
2012-05-23   31.37   32.50  31.36    32.00
2012-05-24   32.95   33.21  31.77    33.03
2012-05-25   32.90   32.95  31.11    31.91
2012-05-29   31.48   31.69  28.65    28.84
2012-05-30   28.70   29.55  27.86    28.19
2012-05-31   28.54   29.67  26.83    29.60
2012-06-01   28.89   29.15  27.39    27.72
2012-06-04   27.20   27.65  26.44    26.90
2012-06-05   26.70   27.76  25.75    25.87
2012-06-06   26.07   27.17  25.52    26.81
2012-06-07   27.00   27.35  26.15    26.31
2012-06-08   26.55   27.76  26.44    27.10
2012-06-11   27.18   28.07  26.84    27.00
2012-06-12   27.48   27.77  26.96    27.40
2012-06-13   27.66   28.10  27.10    27.27
2012-06-14   27.65   28.32  27.38    28.29
2012-06-15   28.50   30.10  28.35    30.01
2012-06-18   29.96   32.08  29.41    31.41
2012-06-19   31.54   32.18  30.70    31.91
2012-06-20   31.92   31.93  31.15    31.60
2012-06-21   31.67   32.50  31.51    31.84
2012-06-22   32.41   33.45  32.06    33.05
2012-06-25   32.86   33.02  31.55    32.06
2012-06-26   32.69   33.44  32.50    33.10
2012-06-27   32.46   32.90  31.90    32.23
2012-06-28   31.96   32.19  30.90    31.36
2012-06-29   31.92   31.99  30.76    31.10
2012-07-02   31.25   31.73  30.55    30.77
2012-07-03   30.91   31.44  30.80    31.20
2012-07-05   31.32   31.62  31.02    31.47
2012-07-06   31.44   31.90  31.26    31.73
2012-07-09   32.10   32.88  31.99    32.17
2012-07-10   32.43   32.48  31.16    31.47
2012-07-11   31.48   31.56  30.55    30.97
2012-07-12   30.70   31.40  30.60    30.81
2012-07-13   31.04   31.07  30.56    30.72
2012-07-16   30.50   30.50  28.21    28.24
2012-07-17   28.48   28.59  27.15    28.09
2012-07-18   28.31   29.29  28.15    29.11
2012-07-19   29.41   29.50  28.63    29.00
2012-07-20   29.00   29.47  28.72    28.76
2012-07-23   28.12   29.00  28.01    28.75
2012-07-24   28.82   29.45  28.10    28.45
2012-07-25   28.39   29.49  28.08    29.34
2012-07-26   27.75   28.23  26.73    26.84
2012-07-27   23.19   24.54  22.28    23.70
2012-07-30   24.00   24.04  23.03    23.15
2012-07-31   23.37   23.37  21.61    21.71
2012-08-01   21.50   21.58  20.84    20.88
2012-08-02   20.77   20.84  19.82    20.04
2012-08-03   20.36   22.16  19.90    21.09
2012-08-06   21.39   22.15  21.30    21.92
2012-08-07   22.20   22.45  20.50    20.72
2012-08-08   20.71   21.15  20.22    20.72
2012-08-09   20.75   21.17  20.61    21.01
2012-08-10   21.41   21.82  21.13    21.81
2012-08-13   22.15   22.45  21.40    21.60
2012-08-14   21.41   21.60  20.25    20.38
2012-08-15   20.64   21.41  20.40    21.20
2012-08-16   20.44   20.48  19.69    19.87
2012-08-17   20.00   20.08  19.00    19.05
2012-08-20   19.05   20.13  18.75    20.01
2012-08-21   19.58   19.98  19.09    19.16
2012-08-22   19.36   19.53  18.96    19.44
2012-08-23   19.50   19.73  19.36    19.44
2012-08-24   19.52   19.68  19.25    19.41
2012-08-27   19.49   19.53  19.10    19.15
2012-08-28   19.10   19.38  18.95    19.34
2012-08-29   19.32   19.38  19.07    19.10
2012-08-30   19.27   19.45  19.06    19.09
2012-08-31   18.68   18.70  18.03    18.06
2012-09-04   18.08   18.27  17.55    17.73
2012-09-05   18.27   18.75  18.18    18.58
2012-09-06   18.74   19.26  18.72    18.96
2012-09-07   19.10   19.42  18.78    18.98
2012-09-10   19.06   19.20  18.55    18.81
2012-09-11   18.92   19.58  18.85    19.43
2012-09-12   20.76   21.16  20.28    20.93
2012-09-13   20.96   21.48  20.61    20.71
2012-09-14   21.13   22.08  20.90    22.00
2012-09-17   22.67   22.75  21.50    21.52
2012-09-18   21.60   21.98  21.37    21.87
2012-09-19   21.99   23.37  21.77    23.29
2012-09-20   23.02   23.24  22.54    22.59
2012-09-21   22.97   23.24  22.60    22.86
2012-09-24   21.77   21.98  20.36    20.79
2012-09-25   21.20   21.21  20.22    20.28
2012-09-26   20.14   20.78  19.80    20.62
2012-09-27   20.99   21.00  20.16    20.32
2012-09-28   20.57   21.95  20.50    21.66
2012-10-01   22.08   22.59  21.73    21.99
2012-10-02   22.08   22.49  21.82    22.27
2012-10-03   22.30   22.49  21.80    21.83
2012-10-04   22.32   22.40  21.41    21.95
2012-10-05   21.49   21.63  20.88    20.91
2012-10-08   20.62   20.75  20.16    20.40
2012-10-09   20.39   20.55  19.97    20.23
2012-10-10   19.93   19.94  19.45    19.64
2012-10-11   19.88   19.96  19.61    19.75
2012-10-12   19.75   19.80  19.48    19.52
2012-10-15   19.68   19.88  19.49    19.52
2012-10-16   19.68   19.69  19.30    19.48
2012-10-17   19.50   20.48  19.37    19.88
2012-10-18   19.70   19.79  18.89    18.98
2012-10-19   19.00   19.06  18.80    19.00
2012-10-22   19.20   19.43  19.05    19.32
2012-10-23   19.25   19.80  19.10    19.50
2012-10-24   24.13   24.25  22.85    23.23
2012-10-25   23.29   23.31  22.47    22.56
2012-10-26   22.40   22.88  21.88    21.94
2012-10-31   20.82   21.50  20.73    21.11
2012-11-01   21.08   21.44  21.01    21.21
2012-11-02   21.26   21.69  21.07    21.18
2012-11-05   21.10   21.48  20.92    21.25
2012-11-06   21.24   21.37  20.99    21.17
2012-11-07   20.85   20.95  20.37    20.47
2012-11-08   20.52   20.73  19.98    19.99
2012-11-09   19.96   20.00  19.13    19.21
2012-11-12   19.15   20.17  18.87    20.07
2012-11-13   19.60   20.11  19.56    19.86
2012-11-14   20.10   22.50  19.93    22.36
2012-11-15   22.34   22.50  21.65    22.17
2012-11-16   22.25   23.93  22.18    23.56
2012-11-19   23.96   24.12  22.82    22.92
2012-11-20   22.73   23.90  22.70    23.10
2012-11-21   23.22   24.53  23.05    24.32
2012-11-23   24.58   24.68  23.88    24.00
2012-11-26   24.94   26.09  24.81    25.94
2012-11-27   26.04   26.50  25.46    26.15
2012-11-28   25.94   26.49  25.75    26.36
2012-11-29   26.50   27.52  26.16    27.32
2012-11-30   27.26   28.00  26.76    28.00
2012-12-03   28.00   28.88  26.98    27.04
2012-12-04   27.06   27.76  26.68    27.46
2012-12-05   27.75   27.90  27.26    27.71
2012-12-06   27.68   27.75  26.82    26.97
2012-12-07   27.07   27.78  26.84    27.48
2012-12-10   27.17   28.17  27.10    27.84
2012-12-11   28.07   28.24  27.66    27.98
2012-12-12   28.00   28.14  27.37    27.58
2012-12-13   27.59   28.75  27.43    28.24
2012-12-14   28.18   28.33  26.76    26.81
2012-12-17   26.77   27.00  26.32    26.75
2012-12-18   26.96   27.91  26.90    27.71
2012-12-19   27.83   28.22  26.95    27.41
2012-12-20   27.49   27.60  27.13    27.36
2012-12-21   26.66   27.01  26.12    26.26
2012-12-24   26.50   26.96  26.20    26.93
2012-12-26   27.03   27.18  26.38    26.51
2012-12-27   26.55   26.80  25.52    26.05
2012-12-28   25.48   26.11  25.15    25.91
2012-12-31   26.20   26.99  26.11    26.62
2013-01-02   27.44   28.18  27.42    28.00
2013-01-03   27.88   28.47  27.59    27.77
2013-01-04   28.01   28.93  27.83    28.76
2013-01-07   28.69   29.79  28.65    29.42
2013-01-08   29.51   29.60  28.86    29.06
2013-01-09   29.67   30.60  29.49    30.59
2013-01-10   30.60   31.45  30.28    31.30
2013-01-11   31.28   31.96  31.10    31.72
2013-01-14   32.08   32.21  30.62    30.95
2013-01-15   30.64   31.71  29.88    30.10
2013-01-16   30.21   30.35  29.53    29.85
2013-01-17   30.08   30.42  30.03    30.14
2013-01-18   30.31   30.44  29.27    29.66
2013-01-22   29.75   30.89  29.74    30.73
2013-01-23   31.10   31.50  30.80    30.82
2013-01-24   31.27   31.49  30.81    31.08
2013-01-25   31.41   31.93  31.13    31.54
2013-01-28   31.88   32.51  31.81    32.47
2013-01-29   32.00   32.07  30.71    30.79
2013-01-30   30.98   31.49  30.88    31.24
2013-01-31   29.15   31.47  28.74    30.98
2013-02-01   31.01   31.02  29.63    29.73
2013-02-04   29.06   29.20  28.01    28.11
2013-02-05   28.26   28.96  28.04    28.64
2013-02-06   28.74   29.29  28.66    29.05
2013-02-07   29.11   29.15  28.27    28.65
2013-02-08   28.89   29.17  28.51    28.54
2013-02-11   28.61   28.68  28.04    28.26
2013-02-12   27.67   28.16  27.10    27.37
2013-02-13   27.36   28.32  27.31    27.91
2013-02-14   28.02   28.63  28.01    28.50
2013-02-15   28.52   28.75  28.09    28.32
2013-02-19   28.23   29.08  28.12    28.93
2013-02-20   28.92   29.05  28.33    28.46
2013-02-21   28.28   28.55  27.15    27.28
2013-02-22   27.62   27.63  26.82    27.13
2013-02-25   27.16   27.64  27.15    27.27
2013-02-26   27.36   27.46  26.70    27.39
2013-02-27   27.34   27.34  26.63    26.87
2013-02-28   26.84   27.30  26.34    27.25
2013-03-01   27.05   28.12  26.81    27.78
2013-03-04   27.76   28.06  27.44    27.72
2013-03-05   27.88   28.18  27.21    27.52
2013-03-06   28.10   28.13  27.35    27.45
2013-03-07   27.57   28.68  27.47    28.58
2013-03-08   28.42   28.47  27.73    27.96
2013-03-11   28.01   28.64  27.83    28.14
2013-03-12   28.10   28.32  27.60    27.83
2013-03-13   27.62   27.65  26.92    27.08
2013-03-14   27.10   27.43  26.83    27.04
2013-03-15   27.03   27.06  26.56    26.64
2013-03-18   26.37   26.79  25.78    26.49
2013-03-19   26.53   26.90  26.21    26.55
2013-03-20   26.68   26.69  25.78    25.86
2013-03-21   25.66   26.11  25.56    25.74
2013-03-22   25.80   26.01  25.63    25.73
2013-03-25   25.75   25.80  25.08    25.13
2013-03-26   25.08   25.48  25.03    25.20
2013-03-27   25.00   26.28  24.72    26.09
2013-03-28   26.09   26.17  25.52    25.58
2013-04-01   25.63   25.89  25.28    25.53
> 
> #FB_Subset <- window(FB, start = as.Date("2000-01-01"), end = as.Date("2013-04-01"))
> #FB_Train <- cbind(FB_Subset$FB.Close - FB_Subset$FB.Open, FB_Subset$FB.Volume)
> train <- cbind(trainset$FB.Close - trainset$FB.Open)
> #print(train)
> 
> testset <- window(FB, start = as.Date("2013-04-02"), end = as.Date("2014-04-01"))
> test <- cbind(testset$FB.Close - testset$FB.Open)
> print(testset)
           FB.Open FB.High FB.Low FB.Close FB.Volume
2013-04-02   25.77   26.12  25.30    25.42  35153292
2013-04-03   25.83   26.39  25.70    26.25  48195118
2013-04-04   26.62   27.23  26.11    27.07  82016745
2013-04-05   26.86   27.80  26.61    27.39  64566510
2013-04-08   27.19   27.20  26.63    26.85  27255982
2013-04-09   26.58   26.89  26.42    26.59  21311013
2013-04-10   27.01   27.84  26.90    27.57  45949361
2013-04-11   27.48   28.10  27.25    28.02  33368462
2013-04-12   28.00   28.00  27.24    27.40  28697400
2013-04-15   27.16   27.48  26.36    26.52  30275356
2013-04-16   26.81   27.11  26.40    26.92  27396392
2013-04-17   26.65   27.20  26.39    26.62  26440537
2013-04-18   26.82   26.82  25.15    25.69  39058905
2013-04-19   25.62   25.96  25.33    25.73  20380862
2013-04-22   25.81   26.36  25.70    25.97  25687549
2013-04-23   26.22   26.33  25.77    25.98  25191467
2013-04-24   25.93   26.40  25.80    26.11  19729809
2013-04-25   26.07   26.40  26.00    26.14  17149965
2013-04-26   26.60   27.62  26.60    26.85  33017958
2013-04-29   27.16   27.41  26.86    26.98  29201070
2013-04-30   27.13   27.85  27.00    27.77  36245633
2013-05-01   27.85   27.92  27.31    27.43  64567590
2013-05-02   28.01   29.02  27.98    28.97 104256921
2013-05-03   29.04   29.07  28.15    28.31  58506376
2013-05-06   28.33   28.46  27.48    27.57  43939307
2013-05-07   27.55   27.85  26.85    26.89  41259083
2013-05-08   26.88   27.30  26.65    27.12  34654851
2013-05-09   27.08   27.55  26.85    27.04  33457150
2013-05-10   27.14   27.30  26.57    26.68  30847022
2013-05-13   26.60   27.32  26.53    26.82  29068764
2013-05-14   26.89   27.28  26.82    27.07  24930207
2013-05-15   26.92   26.99  26.40    26.60  30299761
2013-05-16   26.48   26.55  25.90    26.13  35506976
2013-05-17   26.40   26.60  26.20    26.25  29462605
2013-05-20   26.18   26.19  25.69    25.76  42402874
2013-05-21   25.87   26.08  25.59    25.66  26261210
2013-05-22   25.65   25.85  24.92    25.16  45314475
2013-05-23   24.80   25.53  24.77    25.06  37697202
2013-05-24   24.97   24.97  24.08    24.31  58727882
2013-05-28   24.54   24.54  23.92    24.10  50079642
2013-05-29   23.79   23.81  23.26    23.32  64237702
2013-05-30   24.13   24.78  23.93    24.55  60733122
2013-05-31   24.63   24.95  24.27    24.35  35924917
2013-06-03   24.26   24.32  23.71    23.85  35733795
2013-06-04   23.89   23.93  23.32    23.52  34808997
2013-06-05   23.35   23.70  22.79    22.90  53819645
2013-06-06   22.99   23.09  22.67    22.97  31260660
2013-06-07   23.03   23.40  22.86    23.29  38699124
2013-06-10   24.06   24.60  23.99    24.33  58392986
2013-06-11   24.03   24.35  24.00    24.03  29676383
2013-06-12   24.16   24.26  23.58    23.77  26445790
2013-06-13   23.72   23.83  23.26    23.73  31189247
2013-06-14   23.56   23.89  23.26    23.63  30561387
2013-06-17   23.91   24.25  23.75    24.02  33664419
2013-06-18   24.09   24.69  24.08    24.21  36709004
2013-06-19   24.20   25.19  24.10    24.31  31790525
2013-06-20   24.28   24.74  23.65    23.90  42765586
2013-06-21   24.59   24.70  24.05    24.53  45826173
2013-06-24   23.95   24.11  23.38    23.94  40625948
2013-06-25   24.14   24.43  24.04    24.25  24719988
2013-06-26   24.51   24.65  23.99    24.16  29890205
2013-06-27   24.24   24.84  24.21    24.66  34694013
2013-06-28   24.68   24.98  24.42    24.88  96778879
2013-07-01   24.97   25.06  24.62    24.81  20582195
2013-07-02   24.70   24.77  24.30    24.41  18394008
2013-07-03   24.22   24.71  24.15    24.52  10404332
2013-07-05   24.65   24.66  24.20    24.37  20229451
2013-07-08   24.47   25.04  24.42    24.71  27073983
2013-07-09   25.07   25.49  25.03    25.48  30387889
2013-07-10   25.58   25.83  25.47    25.80  26721794
2013-07-11   25.96   26.00  25.45    25.81  26777354
2013-07-12   25.74   25.93  25.55    25.91  16537840
2013-07-15   25.93   26.43  25.65    26.28  24233957
2013-07-16   26.39   26.75  26.01    26.32  30817554
2013-07-17   26.37   26.78  26.30    26.65  21518463
2013-07-18   26.75   26.77  26.12    26.18  24806825
2013-07-19   25.82   26.11  25.60    25.88  46544938
2013-07-22   25.99   26.13  25.72    26.04  27526213
2013-07-23   26.10   26.30  25.97    26.13  28221534
2013-07-24   26.32   26.53  26.05    26.51  82635587
2013-07-25   33.54   34.88  32.75    34.36 365935212
2013-07-26   33.77   34.73  33.56    34.01 136028897
2013-07-29   34.07   35.63  34.01    35.43 124884870
2013-07-30   35.65   37.96  35.32    37.63 173582710
2013-07-31   37.96   38.31  36.33    36.80 154828679
2013-08-01   37.30   38.29  36.92    37.49 106066472
2013-08-02   37.66   38.49  37.50    38.05  73058424
2013-08-05   38.43   39.32  38.25    39.19  79994774
2013-08-06   39.11   39.25  37.94    38.55  63950791
2013-08-07   38.61   38.94  37.70    38.87  68854764
2013-08-08   39.13   39.19  38.43    38.54  41300906
2013-08-09   38.59   38.74  38.01    38.50  43620024
2013-08-12   38.20   38.50  38.10    38.22  31160951
2013-08-13   38.24   38.32  36.77    37.02  65379198
2013-08-14   36.83   37.55  36.62    36.65  48423890
2013-08-15   36.36   37.07  36.02    36.56  56521095
2013-08-16   36.97   37.49  36.90    37.08  45840714
2013-08-19   37.43   38.28  37.14    37.81  57609591
2013-08-20   38.35   38.58  37.69    38.41  57995140
2013-08-21   38.38   38.85  38.14    38.32  46116868
2013-08-22   38.37   38.75  38.34    38.55  21931163
2013-08-23   39.00   40.63  38.93    40.55  86442283
2013-08-26   40.90   41.94  40.62    41.34  94162358
2013-08-27   40.68   41.20  39.42    39.64  72695050
2013-08-28   39.96   40.85  39.88    40.55  57918194
2013-08-29   40.89   41.78  40.80    41.28  58303395
2013-08-30   42.02   42.26  41.06    41.29  67735053
2013-09-03   41.84   42.16  41.51    41.87  48774896
2013-09-04   42.01   42.17  41.44    41.78  42581854
2013-09-05   41.79   42.76  41.77    42.66  50035380
2013-09-06   43.09   44.61  42.40    43.95 117535626
2013-09-09   44.36   44.79  43.70    44.04  75794696
2013-09-10   44.24   44.26  43.23    43.60  54540282
2013-09-11   43.39   45.09  43.11    45.04  71676653
2013-09-12   45.53   45.62  44.65    44.75  68072239
2013-09-13   45.04   45.08  43.93    44.31  52765299
2013-09-16   44.85   44.94  42.43    42.51  70807761
2013-09-17   42.50   45.44  42.43    45.07  91934557
2013-09-18   44.84   45.47  44.40    45.23  79316945
2013-09-19   45.51   46.05  45.23    45.98  63972369
2013-09-20   46.32   47.60  45.74    47.49 115508400
2013-09-23   47.28   47.55  46.29    47.19  75319202
2013-09-24   48.50   49.66  48.16    48.45 136716101
2013-09-25   49.23   49.54  48.46    49.46  87879619
2013-09-26   50.01   50.60  49.50    50.39  98220046
2013-09-27   50.29   51.28  49.86    51.24  81410460
2013-09-30   50.14   51.60  49.80    50.23 100095417
2013-10-01   49.97   51.03  49.45    50.42  98113699
2013-10-02   50.13   51.10  49.95    50.28  62834429
2013-10-03   50.47   50.72  49.06    49.18  82045323
2013-10-04   49.77   51.16  49.57    51.04  74446947
2013-10-07   50.73   51.29  50.40    50.52  57203957
2013-10-08   50.60   50.60  47.08    47.14 136081330
2013-10-09   47.38   47.84  45.26    46.77 147296862
2013-10-10   47.86   49.68  47.83    49.05  99773784
2013-10-11   49.18   49.87  48.79    49.11  58428451
2013-10-14   48.31   49.63  47.91    49.51  68780552
2013-10-15   49.99   51.00  49.18    49.50  81166571
2013-10-16   50.04   51.24  49.90    51.14  64678247
2013-10-17   51.12   52.22  50.95    52.21  71521899
2013-10-18   54.18   54.82  53.60    54.22  88260093
2013-10-21   54.68   54.81  53.51    53.85  58235283
2013-10-22   54.33   54.76  52.20    52.68  83203892
2013-10-23   51.75   52.25  51.13    51.90  57207154
2013-10-24   52.38   52.84  51.59    52.44  46775185
2013-10-25   53.18   53.24  51.88    51.95  45085348
2013-10-28   51.54   51.70  49.61    50.23  73472347
2013-10-29   50.73   50.79  49.25    49.40 102143469
2013-10-30   50.00   50.21  48.75    49.01 127072652
2013-10-31   47.16   52.00  46.50    50.20 248809006
2013-11-01   50.85   52.09  49.72    49.75  95032876
2013-11-04   49.36   49.75  48.02    48.22  80371218
2013-11-05   47.79   50.18  47.51    50.10  76835006
2013-11-06   50.26   50.45  48.71    49.12  67889337
2013-11-07   49.24   49.87  47.30    47.56  97127618
2013-11-08   47.81   48.65  47.25    47.53  70731178
2013-11-11   47.04   47.53  45.73    46.20  80909626
2013-11-12   46.00   47.37  45.83    46.60  68195832
2013-11-13   46.23   48.74  46.06    48.71  79245346
2013-11-14   48.70   49.57  48.03    48.99  75117049
2013-11-15   49.11   49.48  48.71    49.01  42452937
2013-11-18   48.47   48.84  45.80    45.83  85909884
2013-11-19   46.26   47.00  45.72    46.36  75602413
2013-11-20   46.61   47.55  46.31    46.43  53932698
2013-11-21   46.99   47.46  46.68    46.70  34886170
2013-11-22   47.04   47.27  45.96    46.23  40545375
2013-11-25   46.36   46.65  44.04    44.82  82565324
2013-11-26   44.66   46.17  43.55    45.89  82016490
2013-11-27   45.97   46.67  45.53    46.49  44993195
2013-11-29   46.75   47.21  46.50    47.01  22953916
2013-12-02   46.90   47.54  46.26    47.06  50773647
2013-12-03   46.75   47.20  46.29    46.73  32085905
2013-12-04   46.46   48.77  46.26    48.62  60890176
2013-12-05   48.15   48.70  47.87    48.34  43855036
2013-12-06   48.98   49.39  47.71    47.94  42937659
2013-12-09   48.06   48.97  47.74    48.84  36055891
2013-12-10   48.62   50.77  48.54    50.24  68478561
2013-12-11   50.56   50.77  49.01    49.38  65776366
2013-12-12   51.03   52.07  50.66    51.83  92723034
2013-12-13   51.61   53.50  51.34    53.32  82640992
2013-12-16   53.27   54.50  52.91    53.81  85118518
2013-12-17   54.75   55.18  54.24    54.86  78751463
2013-12-18   55.57   55.89  53.75    55.57  76003479
2013-12-19   54.34   55.19  53.95    55.05  89825393
2013-12-20   54.91   55.15  54.23    55.12 239823912
2013-12-23   55.50   58.32  55.45    57.77  98296983
2013-12-24   58.27   58.58  56.91    57.96  46617754
2013-12-26   58.32   58.38  57.37    57.73  55101367
2013-12-27   57.48   57.68  55.25    55.44  60465751
2013-12-30   54.93   55.18  53.43    53.71  68307317
2013-12-31   54.12   54.86  53.91    54.65  43152127
2014-01-02   54.83   55.22  54.19    54.71  43257622
2014-01-03   55.02   55.65  54.53    54.56  38287706
2014-01-06   54.42   57.26  54.05    57.20  68974359
2014-01-07   57.70   58.55  57.22    57.92  77329009
2014-01-08   57.60   58.41  57.23    58.23  56800776
2014-01-09   58.65   58.96  56.65    57.22  92349222
2014-01-10   57.13   58.30  57.06    57.94  42529258
2014-01-13   57.91   58.25  55.38    55.91  63106519
2014-01-14   56.46   57.78  56.10    57.74  37590987
2014-01-15   57.98   58.57  57.27    57.60  33730619
2014-01-16   57.26   58.02  56.83    57.19  34599775
2014-01-17   57.30   57.82  56.07    56.30  40883205
2014-01-21   56.60   58.58  56.50    58.51  48734147
2014-01-22   58.85   59.31  57.10    57.51  61495880
2014-01-23   56.37   56.68  55.69    56.63  47996403
2014-01-24   56.15   56.42  54.40    54.45  55545338
2014-01-27   54.73   54.94  51.85    53.55  74142331
2014-01-28   54.02   55.28  54.00    55.14  48364998
2014-01-29   54.61   54.95  53.19    53.53  98089932
2014-01-30   62.12   62.50  60.46    61.08 150438699
2014-01-31   60.47   63.37  60.17    62.57  87930298
2014-02-03   63.03   63.77  60.70    61.48  75105994
2014-02-04   62.05   63.14  61.82    62.75  46064897
2014-02-05   62.74   63.16  61.27    62.19  53032420
2014-02-06   61.46   62.78  61.46    62.16  42153754
2014-02-07   62.27   64.57  62.22    64.32  60835746
2014-02-10   64.30   64.49  63.47    63.55  43736562
2014-02-11   63.75   65.00  63.35    64.85  45746832
2014-02-12   64.92   65.06  64.05    64.45  47409857
2014-02-13   64.18   67.33  64.05    67.33  62013396
2014-02-14   67.50   67.58  66.72    67.09  36786427
2014-02-18   66.94   67.54  66.07    67.30  43862297
2014-02-19   67.05   69.08  67.00    68.06  64258631
2014-02-20   67.73   70.11  65.73    69.63 131043748
2014-02-21   69.69   69.96  68.45    68.59  70991892
2014-02-24   68.74   71.44  68.54    70.78  76951946
2014-02-25   70.95   71.00  69.45    69.85  52189031
2014-02-26   70.19   71.22  68.85    69.26  55400399
2014-02-27   69.34   70.01  68.87    68.94  41695855
2014-02-28   69.47   69.88  67.38    68.46  66900863
2014-03-03   66.96   68.05  66.51    67.41  56900444
2014-03-04   68.66   68.90  67.62    68.80  42164222
2014-03-05   69.69   71.97  69.62    71.57  74649486
2014-03-06   71.88   71.89  70.25    70.84  46126260
2014-03-07   71.08   71.18  69.47    69.80  38985763
2014-03-10   70.77   72.15  70.51    72.03  59949746
2014-03-11   72.50   72.59  69.96    70.10  59615238
2014-03-12   69.86   71.35  69.00    70.88  46400431
2014-03-13   71.29   71.35  68.15    68.83  57091157
2014-03-14   68.49   69.43  67.46    67.72  48226824
2014-03-17   68.18   68.95  66.62    68.74  52196699
2014-03-18   68.76   69.60  68.30    69.19  40827226
2014-03-19   69.17   69.29  67.46    68.24  43980558
2014-03-20   68.01   68.23  66.82    66.97  44438500
2014-03-21   67.53   67.92  66.18    67.24  60041228
2014-03-24   67.19   67.36  63.36    64.10  85695872
2014-03-25   64.89   66.19  63.78    64.89  68785500
2014-03-26   64.74   64.95  60.37    60.38  97689774
2014-03-27   60.51   61.90  57.98    60.97 112649694
2014-03-28   61.34   61.95  59.34    60.01  67051528
2014-03-31   60.78   61.52  59.87    60.24  53011205
2014-04-01   60.46   62.66  60.24    62.62  59291210
> 
> # Baum-Welch Algorithm to find the model for the given observations
> #hm_model <- HMMFit(obs = FB_Train, nStates = 5)
> hm_model <- HMMFit(obs = train, nStates = 5, nMixt = 4, dis = "MIXTURE")
> print(hm_model)

Call:
----
HMMFit(obs = train, dis = "MIXTURE", nStates = 5, nMixt = 4)

Model:
------
5 states HMM with mixture of 4 gaussian distribution

Baum-Welch algorithm status:
----------------------------

NO CONVERGENCE AFTER 57 ITERATIONS

PROBLEM IN BAUM-WELCH'S ALGORITHM

Last Estimation:
----------------

Initial probabilities:
  Pi 1 Pi 2 Pi 3 Pi 4 Pi 5
     0    0    0    0    1

Transition matrix:
             State 1      State 2     State 3      State 4      State 5
State 1 1.270467e-01 2.358334e-01 0.045538712 5.915812e-01 1.841071e-33
State 2 1.636799e-01 8.173341e-01 0.003894046 1.509202e-02 4.260177e-31
State 3 5.024441e-01 3.001118e-03 0.166559220 3.279956e-01 1.021199e-26
State 4 3.889200e-03 1.597617e-01 0.788560363 4.778872e-02 8.065209e-32
State 5 2.476911e-11 1.161343e-30 0.143254201 6.535601e-31 8.567458e-01

Conditionnal distribution parameters:

Distribution parameters:
  State 1
                mean       var        prop
mixt.  1  0.33364078 0.1656507 0.001104362
mixt.  2 -0.08049560 0.2813550 0.088580026
mixt.  3  0.08802206 0.2659329 0.354965665
mixt.  4  0.36332710 0.1511659 0.555349947

  State 2
               mean       var        prop
mixt.  1 -1.1249494 0.9625545 0.009620304
mixt.  2 -0.4444104 0.0050508 0.102911252
mixt.  3 -0.2175221 0.1348040 0.230689094
mixt.  4 -0.1496387 0.1341898 0.656779350

  State 3
               mean       var       prop
mixt.  1  1.7486045 0.2188680 0.05709735
mixt.  2 -0.7367594 0.1438948 0.19756494
mixt.  3 -0.7508740 0.1431202 0.21977466
mixt.  4 -0.6257665 0.1347444 0.52556305

  State 4
               mean        var       prop
mixt.  1  0.7576561 0.25477570 0.08726846
mixt.  2 -1.0909965 0.60884826 0.10914210
mixt.  3  0.7139754 0.30821605 0.34134616
mixt.  4  0.6684548 0.05557903 0.46224328

  State 5
               mean         var      prop
mixt.  1 -3.8200000 0.000000000 0.1432542
mixt.  2 -2.5695682 0.004899814 0.2846873
mixt.  3 -1.2996846 0.097443197 0.2855397
mixt.  4  0.3563104 0.077032929 0.2865188


Log-likelihood: NaN
BIC criterium: NaN
AIC criterium: NaN
> 
> # Viterbi Algorithm to find the most probable state sequence
> VitPath <- viterbi (hm_model, train)
> print(VitPath)
$states
  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

$logViterbiScore
[1] -Inf

$logProbSeq
[1] NaN

attr(,"class")
[1] "viterbiClass"
> 
> # scatter plot
> postscript('FB.eps')
> FB_Predict <- cbind(trainset$FB.Close, VitPath$states)
> #FB_Predict <- cbind(FB_Subset$FB.Close, VitPath$states)
> #print(FB_Subset[,4] - FB_Predict [,1])
> 
> # predict next stock value m = nMixt, n = nStates
> #sum(a[last(v),] * .colSums((matrix(unlist(a), nrow=4,ncol=5)) * (matrix(unlist(a), nrow=4,ncol=5)), m=4,n=5))
> # gaussian mixture HMM: nrow = nMixture, ncol = nStates
> #print(hm_model$HMM$transMat[last(VitPath$states),])
> #print(hm_model$HMM$distribution$mean[, seq(1, ncol(hm_model$HMM$distribution$mean), by = 2)])
> #print(unlist(hm_model$HMM$distribution$mean))
> #print(matrix(unlist(hm_model$HMM$distribution$proportion[1,])))
> 
> # add a new colum "Pred"
> testset <- cbind(testset, Pred = 0)
> #testset <- cbind(testset$FB.Close, Pred = 0)
> #print(testset)
> 
> #chartSeries(testset, theme="white")
> #chartSeries(test, theme="white")
> 
> # number of rows of test set data
> rows = nrow(testset)
> 
> MAPEsum = 0
> NRMSEsum = 0
> #MAPEsum <- 0
> 
> # predict and update HMM to include the new actual value
> #for (i in 1: 251) {
> #for (i in 1: 3) {
> for (i in 1: rows) {
+ 	#if (i == rows) break
+ 
+ 	if(i != 0) {
+ 		testrow <- testset[i, ]
+ 		#print(testrow)
+ 		todayopen <- testset$FB.Open[i, ]
+ 		actual <- testset$FB.Close[i, ]
+ 		#todayclose <- testset$FB.Close[i, ]
+ 	}
+ 
+ 	# predict the closing value of today
+ 	change <- sum(hm_model$HMM$transMat[last(VitPath$states),] * .colSums((matrix(unlist(hm_model$HMM$distribution$mean), nrow=4,ncol=5)) * (matrix(unlist(hm_model$HMM$distribution$proportion), nrow=4,ncol=5)), m=4,n=5))
+ 	#sum(hm_model$HMM$transMat[last(VitPath$states),] * .colSums((matrix(unlist(hm_model$HMM$distribution$mean[1,]), nrow=4,ncol=5)) * (matrix(unlist(hm_model$HMM$distribution$proportion[1,]), nrow=4,ncol=5)), m=4,n=5))
+ 	print(change)
+ 
+ 	pred <- todayopen + change
+ 	#testrow$Pred <- pred
+ 	#print(pred)
+ 
+ 	# update today's predicted value
+ 	testset[i, ]$Pred <- pred
+ 	print(testset[i, ])
+ 
+ 	# MAPE = sum(|pred - actual|/|actual|)*100/n
+ 	diff = (abs ((pred - actual)/ actual))[1,]$FB.Open
+ 	#print (diff)
+ 	#MAPEsum <- MAPEsum + diff$FB.Open
+ 	MAPEsum <- sum(MAPEsum, diff[1,1])
+ 	#MAPEsum = MAPEsum + abs((pred - actual)/todayclose)
+ 	#print(MAPEsum)
+ 	#MAPE <- MAPEsum*100/rows
+ 	#print(MAPE)
+ 
+ 	# NRMSE = sqrt(sum((pred - actual)^2) / n)
+ 	NRMSEsum <- sum(NRMSEsum, (pred - actual)^2) 
+ 
+ 	# ROC
+ 
+ 	# [Optional] Returns: sell or buy
+ 	# if stock would increase sell, otherwise buy
+ 
+ 	# single HMM
+ 	#sum(hm_model$HMM$transMat[last(VitPath$states),] * .colSums((matrix(unlist(hm_model$HMM$distribution$mean), nrow=1,ncol=5)) * (matrix(unlist(hm_model$HMM$distribution$proportion), nrow=1,ncol=5)), m=1,n=5))
+ 
+ 	# update train data
+ 	train <- rbind (train, todayclose - todayopen)
+ 	
+ 	# update HMM with the new data
+ 	# Baum-Welch Algorithm to find the model for the given observations
+ 	hm_model <- HMMFit(obs = train, nStates = 5, nMixt = 4, dis = "MIXTURE")
+ 
+ 	# Viterbi Algorithm to find the most probable state sequence
+ 	VitPath <- viterbi (hm_model, train)
+ }
[1] 0.2514629
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-02   25.77   26.12   25.3    25.42  35153292 26.02146
[1] -0.08309697
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-04-03   25.83   26.39   25.7    26.25  48195118 25.7469
[1] -0.05585469
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-04   26.62   27.23  26.11    27.07  82016745 26.56415
[1] -0.2648781
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-05   26.86    27.8  26.61    27.39  64566510 26.59512
[1] -0.108219
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-08   27.19    27.2  26.63    26.85  27255982 27.08178
[1] -0.130022
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-09   26.58   26.89  26.42    26.59  21311013 26.44998
[1] -0.01236071
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-10   27.01   27.84   26.9    27.57  45949361 26.99764
[1] -0.04074686
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-11   27.48    28.1  27.25    28.02  33368462 27.43925
[1] -0.1750211
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-12      28      28  27.24     27.4  28697400 27.82498
[1] -0.2137893
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-15   27.16   27.48  26.36    26.52  30275356 26.94621
[1] -0.1841492
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-16   26.81   27.11   26.4    26.92  27396392 26.62585
[1] -0.08302614
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-17   26.65    27.2  26.39    26.62  26440537 26.56697
[1] -0.02302558
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-18   26.82   26.82  25.15    25.69  39058905 26.79697
[1] 4.111463e-05
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-19   25.62   25.96  25.33    25.73  20380862 25.62004
[1] 0.204981
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-22   25.81   26.36   25.7    25.97  25687549 26.01498
[1] -0.0254422
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-23   26.22   26.33  25.77    25.98  25191467 26.19456
[1] -0.02298352
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-24   25.93    26.4   25.8    26.11  19729809 25.90702
[1] 0.01572296
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-25   26.07    26.4     26    26.14  17149965 26.08572
[1] -0.1377749
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-26    26.6   27.62   26.6    26.85  33017958 26.46223
[1] 0.07644997
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-29   27.16   27.41  26.86    26.98  29201070 27.23645
[1] -0.0399908
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-04-30   27.13   27.85     27    27.77  36245633 27.09001
[1] -0.05669885
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-05-01   27.85   27.92  27.31    27.43  64567590 27.7933
[1] 0.1437075
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-02   28.01   29.02  27.98    28.97 104256921 28.15371
[1] -0.01845829
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-03   29.04   29.07  28.15    28.31  58506376 29.02154
[1] 0.1966548
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-06   28.33   28.46  27.48    27.57  43939307 28.52665
[1] -0.003017953
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-07   27.55   27.85  26.85    26.89  41259083 27.54698
[1] -0.06603326
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-08   26.88    27.3  26.65    27.12  34654851 26.81397
[1] 0.2357161
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-09   27.08   27.55  26.85    27.04  33457150 27.31572
[1] -0.03303079
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-10   27.14    27.3  26.57    26.68  30847022 27.10697
[1] -0.1561489
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-13    26.6   27.32  26.53    26.82  29068764 26.44385
[1] -0.1255202
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-14   26.89   27.28  26.82    27.07  24930207 26.76448
[1] 0.03120018
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-05-15   26.92   26.99   26.4     26.6  30299761 26.9512
[1] 0.1508157
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-16   26.48   26.55   25.9    26.13  35506976 26.63082
[1] -0.076907
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-17    26.4    26.6   26.2    26.25  29462605 26.32309
[1] 0.1085474
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-20   26.18   26.19  25.69    25.76  42402874 26.28855
[1] -0.05888527
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-21   25.87   26.08  25.59    25.66  26261210 25.81111
[1] -0.006103659
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-05-22   25.65   25.85  24.92    25.16  45314475 25.6439
[1] 0.1998809
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-23    24.8   25.53  24.77    25.06  37697202 24.99988
[1] -0.02371033
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-24   24.97   24.97  24.08    24.31  58727882 24.94629
[1] -0.1673343
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-28   24.54   24.54  23.92     24.1  50079642 24.37267
[1] -0.5109
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-05-29   23.79   23.81  23.26    23.32  64237702 23.2791
[1] -0.1226065
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-30   24.13   24.78  23.93    24.55  60733122 24.00739
[1] -0.05408583
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-05-31   24.63   24.95  24.27    24.35  35924917 24.57591
[1] -0.0948771
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-03   24.26   24.32  23.71    23.85  35733795 24.16512
[1] 0.2258897
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-04   23.89   23.93  23.32    23.52  34808997 24.11589
[1] 0.07434817
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-05   23.35    23.7  22.79     22.9  53819645 23.42435
[1] -0.05394399
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-06   22.99   23.09  22.67    22.97  31260660 22.93606
[1] -0.047102
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-06-07   23.03    23.4  22.86    23.29  38699124 22.9829
[1] -0.04742209
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-10   24.06    24.6  23.99    24.33  58392986 24.01258
[1] -0.1178743
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-11   24.03   24.35     24    24.03  29676383 23.91213
[1] -0.08145203
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-12   24.16   24.26  23.58    23.77  26445790 24.07855
[1] -0.05177507
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-13   23.72   23.83  23.26    23.73  31189247 23.66822
[1] -0.005443187
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-14   23.56   23.89  23.26    23.63  30561387 23.55456
[1] 0.05010126
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-06-17   23.91   24.25  23.75    24.02  33664419 23.9601
[1] -0.1615461
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-18   24.09   24.69  24.08    24.21  36709004 23.92845
[1] -0.03713966
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-19    24.2   25.19   24.1    24.31  31790525 24.16286
[1] -0.2502563
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-20   24.28   24.74  23.65     23.9  42765586 24.02974
[1] -0.1326111
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-21   24.59    24.7  24.05    24.53  45826173 24.45739
[1] -0.1138444
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-24   23.95   24.11  23.38    23.94  40625948 23.83616
[1] -0.06452439
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-25   24.14   24.43  24.04    24.25  24719988 24.07548
[1] -0.1168988
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-06-26   24.51   24.65  23.99    24.16  29890205 24.3931
[1] -0.07010332
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-06-27   24.24   24.84  24.21    24.66  34694013 24.1699
[1] -0.1467386
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-06-28   24.68   24.98  24.42    24.88  96778879 24.53326
[1] -0.06510422
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-07-01   24.97   25.06  24.62    24.81  20582195 24.9049
[1] -0.03588701
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-02    24.7   24.77   24.3    24.41  18394008 24.66411
[1] -0.0503884
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-03   24.22   24.71  24.15    24.52  10404332 24.16961
[1] -0.05961013
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-05   24.65   24.66   24.2    24.37  20229451 24.59039
[1] -0.168543
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-08   24.47   25.04  24.42    24.71  27073983 24.30146
[1] -0.04349374
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-09   25.07   25.49  25.03    25.48  30387889 25.02651
[1] -0.09419614
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-07-10   25.58   25.83  25.47     25.8  26721794 25.4858
[1] -0.09946458
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-11   25.96      26  25.45    25.81  26777354 25.86054
[1] 0.3231747
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-12   25.74   25.93  25.55    25.91  16537840 26.06317
[1] -0.099724
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-15   25.93   26.43  25.65    26.28  24233957 25.83028
[1] -0.1139973
           FB.Open FB.High FB.Low FB.Close FB.Volume   Pred
2013-07-16   26.39   26.75  26.01    26.32  30817554 26.276
[1] -0.2301712
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-17   26.37   26.78   26.3    26.65  21518463 26.13983
[1] 0.12574
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-18   26.75   26.77  26.12    26.18  24806825 26.87574
[1] -0.09814893
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-19   25.82   26.11   25.6    25.88  46544938 25.72185
[1] -0.1490312
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-22   25.99   26.13  25.72    26.04  27526213 25.84097
[1] -0.05821521
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-23    26.1    26.3  25.97    26.13  28221534 26.04178
[1] 0.04704928
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-24   26.32   26.53  26.05    26.51  82635587 26.36705
[1] -0.03932401
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-25   33.54   34.88  32.75    34.36 365935212 33.50068
[1] 0.3383487
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-26   33.77   34.73  33.56    34.01 136028897 34.10835
[1] 0.2335983
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-07-29   34.07   35.63  34.01    35.43 124884870 34.3036
[1] -0.04726798
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-30   35.65   37.96  35.32    37.63 173582710 35.60273
[1] -0.06736161
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-07-31   37.96   38.31  36.33     36.8 154828679 37.89264
[1] -0.286195
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-01    37.3   38.29  36.92    37.49 106066472 37.01381
[1] -0.07602618
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-02   37.66   38.49   37.5    38.05  73058424 37.58397
[1] -0.0908066
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-05   38.43   39.32  38.25    39.19  79994774 38.33919
[1] 0.04241711
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-06   39.11   39.25  37.94    38.55  63950791 39.15242
[1] -0.09843232
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-07   38.61   38.94   37.7    38.87  68854764 38.51157
[1] 0.08047738
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-08   39.13   39.19  38.43    38.54  41300906 39.21048
[1] -0.04640153
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-08-09   38.59   38.74  38.01     38.5  43620024 38.5436
[1] -0.05774487
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-12    38.2    38.5   38.1    38.22  31160951 38.14226
[1] 0.03779594
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-08-13   38.24   38.32  36.77    37.02  65379198 38.2778
[1] -0.02531097
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-14   36.83   37.55  36.62    36.65  48423890 36.80469
[1] -0.01291639
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-15   36.36   37.07  36.02    36.56  56521095 36.34708
[1] -0.204667
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-16   36.97   37.49   36.9    37.08  45840714 36.76533
[1] -0.1318589
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-19   37.43   38.28  37.14    37.81  57609591 37.29814
[1] -0.1056095
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-20   38.35   38.58  37.69    38.41  57995140 38.24439
[1] 0.3468815
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-21   38.38   38.85  38.14    38.32  46116868 38.72688
[1] 0.02632668
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-22   38.37   38.75  38.34    38.55  21931163 38.39633
[1] -0.1707587
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-23      39   40.63  38.93    40.55  86442283 38.82924
[1] -0.01338382
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-26    40.9   41.94  40.62    41.34  94162358 40.88662
[1] -0.1175744
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-27   40.68    41.2  39.42    39.64  72695050 40.56243
[1] 0.2305753
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-28   39.96   40.85  39.88    40.55  57918194 40.19058
[1] 0.05162821
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-29   40.89   41.78   40.8    41.28  58303395 40.94163
[1] 0.116439
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-08-30   42.02   42.26  41.06    41.29  67735053 42.13644
[1] 0.05156419
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-03   41.84   42.16  41.51    41.87  48774896 41.89156
[1] 0.09391577
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-04   42.01   42.17  41.44    41.78  42581854 42.10392
[1] -0.1031355
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-05   41.79   42.76  41.77    42.66  50035380 41.68686
[1] -0.05025244
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-06   43.09   44.61   42.4    43.95 117535626 43.03975
[1] 0.009236859
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-09   44.36   44.79   43.7    44.04  75794696 44.36924
[1] -0.01991004
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-10   44.24   44.26  43.23     43.6  54540282 44.22009
[1] -0.1277237
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-11   43.39   45.09  43.11    45.04  71676653 43.26228
[1] 0.05644382
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-12   45.53   45.62  44.65    44.75  68072239 45.58644
[1] -0.1415491
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-13   45.04   45.08  43.93    44.31  52765299 44.89845
[1] -0.02535834
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-16   44.85   44.94  42.43    42.51  70807761 44.82464
[1] -0.0797003
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-09-17    42.5   45.44  42.43    45.07  91934557 42.4203
[1] -0.1257405
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-18   44.84   45.47   44.4    45.23  79316945 44.71426
[1] 0.108725
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-19   45.51   46.05  45.23    45.98  63972369 45.61872
[1] 0.02314382
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-20   46.32    47.6  45.74    47.49 115508400 46.34314
[1] -0.2078599
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-23   47.28   47.55  46.29    47.19  75319202 47.07214
[1] -0.1094435
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-24    48.5   49.66  48.16    48.45 136716101 48.39056
[1] -0.1442139
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-25   49.23   49.54  48.46    49.46  87879619 49.08579
[1] -0.1079753
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-26   50.01    50.6   49.5    50.39  98220046 49.90202
[1] 0.04222054
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-27   50.29   51.28  49.86    51.24  81410460 50.33222
[1] -0.05862827
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-09-30   50.14    51.6   49.8    50.23 100095417 50.08137
[1] -0.07714949
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-01   49.97   51.03  49.45    50.42  98113699 49.89285
[1] -0.04258635
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-02   50.13    51.1  49.95    50.28  62834429 50.08741
[1] -0.1532592
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-03   50.47   50.72  49.06    49.18  82045323 50.31674
[1] -0.1199926
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-04   49.77   51.16  49.57    51.04  74446947 49.65001
[1] -0.1343653
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-07   50.73   51.29   50.4    50.52  57203957 50.59563
[1] -0.02763882
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-08    50.6    50.6  47.08    47.14 136081330 50.57236
[1] -0.01907723
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-09   47.38   47.84  45.26    46.77 147296862 47.36092
[1] -0.01281149
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-10   47.86   49.68  47.83    49.05  99773784 47.84719
[1] -0.05735671
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-11   49.18   49.87  48.79    49.11  58428451 49.12264
[1] -0.1358116
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-14   48.31   49.63  47.91    49.51  68780552 48.17419
[1] -0.08150274
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-10-15   49.99      51  49.18     49.5  81166571 49.9085
[1] -0.04483187
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-16   50.04   51.24   49.9    51.14  64678247 49.99517
[1] 0.1664396
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-17   51.12   52.22  50.95    52.21  71521899 51.28644
[1] -0.157693
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-18   54.18   54.82   53.6    54.22  88260093 54.02231
[1] -0.09137152
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-21   54.68   54.81  53.51    53.85  58235283 54.58863
[1] -0.08183277
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-22   54.33   54.76   52.2    52.68  83203892 54.24817
[1] 0.07580373
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-10-23   51.75   52.25  51.13     51.9  57207154 51.8258
[1] -0.06762175
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-24   52.38   52.84  51.59    52.44  46775185 52.31238
[1] -0.1094654
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-25   53.18   53.24  51.88    51.95  45085348 53.07053
[1] -0.05581344
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-28   51.54    51.7  49.61    50.23  73472347 51.48419
[1] -0.0818245
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-29   50.73   50.79  49.25     49.4 102143469 50.64818
[1] -0.03214299
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-10-30      50   50.21  48.75    49.01 127072652 49.96786
[1] -0.1134951
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-10-31   47.16      52   46.5     50.2 248809006 47.0465
[1] 0.1397022
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-11-01   50.85   52.09  49.72    49.75  95032876 50.9897
[1] -0.2214993
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-11-04   49.36   49.75  48.02    48.22  80371218 49.1385
[1] -0.0513197
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-05   47.79   50.18  47.51     50.1  76835006 47.73868
[1] -0.01631726
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-06   50.26   50.45  48.71    49.12  67889337 50.24368
[1] -0.09362535
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-07   49.24   49.87   47.3    47.56  97127618 49.14637
[1] 0.07281271
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-08   47.81   48.65  47.25    47.53  70731178 47.88281
[1] 0.02369964
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-11-11   47.04   47.53  45.73     46.2  80909626 47.0637
[1] -0.1802693
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-12      46   47.37  45.83     46.6  68195832 45.81973
[1] 0.004505303
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-13   46.23   48.74  46.06    48.71  79245346 46.23451
[1] -0.04419037
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-14    48.7   49.57  48.03    48.99  75117049 48.65581
[1] -0.02740748
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-15   49.11   49.48  48.71    49.01  42452937 49.08259
[1] -0.1132029
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-11-18   48.47   48.84   45.8    45.83  85909884 48.3568
[1] 0.08233138
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-19   46.26      47  45.72    46.36  75602413 46.34233
[1] -0.09823802
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-20   46.61   47.55  46.31    46.43  53932698 46.51176
[1] -0.07294348
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-21   46.99   47.46  46.68     46.7  34886170 46.91706
[1] -0.03511774
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-22   47.04   47.27  45.96    46.23  40545375 47.00488
[1] 0.2225231
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-25   46.36   46.65  44.04    44.82  82565324 46.58252
[1] 0.05909139
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-26   44.66   46.17  43.55    45.89  82016490 44.71909
[1] -0.227561
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-27   45.97   46.67  45.53    46.49  44993195 45.74244
[1] -0.3992108
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-11-29   46.75   47.21   46.5    47.01  22953916 46.35079
[1] 0.2741712
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-02    46.9   47.54  46.26    47.06  50773647 47.17417
[1] -0.125632
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-03   46.75    47.2  46.29    46.73  32085905 46.62437
[1] -0.1477789
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-04   46.46   48.77  46.26    48.62  60890176 46.31222
[1] -0.05882291
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-05   48.15    48.7  47.87    48.34  43855036 48.09118
[1] -0.06959738
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-12-06   48.98   49.39  47.71    47.94  42937659 48.9104
[1] -0.05684946
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-09   48.06   48.97  47.74    48.84  36055891 48.00315
[1] -0.05369609
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-12-10   48.62   50.77  48.54    50.24  68478561 48.5663
[1] -0.1056579
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-11   50.56   50.77  49.01    49.38  65776366 50.45434
[1] -0.02543248
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-12   51.03   52.07  50.66    51.83  92723034 51.00457
[1] -0.04774829
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-13   51.61    53.5  51.34    53.32  82640992 51.56225
[1] -0.08989893
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-12-16   53.27    54.5  52.91    53.81  85118518 53.1801
[1] -0.04340587
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-17   54.75   55.18  54.24    54.86  78751463 54.70659
[1] 0.07222866
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-18   55.57   55.89  53.75    55.57  76003479 55.64223
[1] -0.07589591
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-12-19   54.34   55.19  53.95    55.05  89825393 54.2641
[1] -0.01380144
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-12-20   54.91   55.15  54.23    55.12 239823912 54.8962
[1] -0.07281279
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-23    55.5   58.32  55.45    57.77  98296983 55.42719
[1] -0.208397
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-12-24   58.27   58.58  56.91    57.96  46617754 58.0616
[1] -0.04718315
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-26   58.32   58.38  57.37    57.73  55101367 58.27282
[1] -0.02329791
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2013-12-27   57.48   57.68  55.25    55.44  60465751 57.4567
[1] -0.3213545
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-30   54.93   55.18  53.43    53.71  68307317 54.60865
[1] 0.05235289
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2013-12-31   54.12   54.86  53.91    54.65  43152127 54.17235
[1] -0.02491195
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-02   54.83   55.22  54.19    54.71  43257622 54.80509
[1] -0.1093422
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-03   55.02   55.65  54.53    54.56  38287706 54.91066
[1] -0.05740796
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-06   54.42   57.26  54.05     57.2  68974359 54.36259
[1] -0.03208318
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-07    57.7   58.55  57.22    57.92  77329009 57.66792
[1] -0.5094596
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-08    57.6   58.41  57.23    58.23  56800776 57.09054
[1] -0.01457104
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-09   58.65   58.96  56.65    57.22  92349222 58.63543
[1] -0.07152637
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-10   57.13    58.3  57.06    57.94  42529258 57.05847
[1] -0.1118647
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-13   57.91   58.25  55.38    55.91  63106519 57.79814
[1] -0.02489608
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2014-01-14   56.46   57.78   56.1    57.74  37590987 56.4351
[1] -0.2777711
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-15   57.98   58.57  57.27     57.6  33730619 57.70223
[1] -0.06773877
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-16   57.26   58.02  56.83    57.19  34599775 57.19226
[1] -0.2482896
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-17    57.3   57.82  56.07     56.3  40883205 57.05171
[1] -0.1715055
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-21    56.6   58.58   56.5    58.51  48734147 56.42849
[1] -0.06296786
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-22   58.85   59.31   57.1    57.51  61495880 58.78703
[1] 0.02050405
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2014-01-23   56.37   56.68  55.69    56.63  47996403 56.3905
[1] -0.05116765
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-24   56.15   56.42   54.4    54.45  55545338 56.09883
[1] -0.04531725
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-27   54.73   54.94  51.85    53.55  74142331 54.68468
[1] 0.008239661
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-28   54.02   55.28     54    55.14  48364998 54.02824
[1] -0.1364633
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-29   54.61   54.95  53.19    53.53  98089932 54.47354
[1] -0.2874377
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-30   62.12    62.5  60.46    61.08 150438699 61.83256
[1] 0.2699578
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-01-31   60.47   63.37  60.17    62.57  87930298 60.73996
[1] -0.06206015
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-03   63.03   63.77   60.7    61.48  75105994 62.96794
[1] 0.06344857
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-04   62.05   63.14  61.82    62.75  46064897 62.11345
[1] -0.0242079
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-05   62.74   63.16  61.27    62.19  53032420 62.71579
[1] -0.1300913
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-06   61.46   62.78  61.46    62.16  42153754 61.32991
[1] 0.2385917
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-07   62.27   64.57  62.22    64.32  60835746 62.50859
[1] -0.05808616
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-10    64.3   64.49  63.47    63.55  43736562 64.24191
[1] -0.061844
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-11   63.75      65  63.35    64.85  45746832 63.68816
[1] -0.0329625
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-12   64.92   65.06  64.05    64.45  47409857 64.88704
[1] -0.1128527
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-13   64.18   67.33  64.05    67.33  62013396 64.06715
[1] -0.03202616
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-14    67.5   67.58  66.72    67.09  36786427 67.46797
[1] 0.005340879
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-18   66.94   67.54  66.07     67.3  43862297 66.94534
[1] -0.03646633
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-19   67.05   69.08     67    68.06  64258631 67.01353
[1] 0.1680367
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-20   67.73   70.11  65.73    69.63 131043748 67.89804
[1] 0.1698015
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2014-02-21   69.69   69.96  68.45    68.59  70991892 69.8598
[1] 0.09609746
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2014-02-24   68.74   71.44  68.54    70.78  76951946 68.8361
[1] -0.1256956
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2014-02-25   70.95      71  69.45    69.85  52189031 70.8243
[1] -0.03696711
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-26   70.19   71.22  68.85    69.26  55400399 70.15303
[1] -0.1203292
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-27   69.34   70.01  68.87    68.94  41695855 69.21967
[1] -0.08691432
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-02-28   69.47   69.88  67.38    68.46  66900863 69.38309
[1] 0.07212271
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-03   66.96   68.05  66.51    67.41  56900444 67.03212
[1] -0.03747791
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-04   68.66    68.9  67.62     68.8  42164222 68.62252
[1] -0.1110329
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-05   69.69   71.97  69.62    71.57  74649486 69.57897
[1] -0.1437003
           FB.Open FB.High FB.Low FB.Close FB.Volume    Pred
2014-03-06   71.88   71.89  70.25    70.84  46126260 71.7363
[1] -0.09465776
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-07   71.08   71.18  69.47     69.8  38985763 70.98534
[1] -0.05184081
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-10   70.77   72.15  70.51    72.03  59949746 70.71816
[1] -0.1611821
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-11    72.5   72.59  69.96     70.1  59615238 72.33882
[1] 0.1178931
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-12   69.86   71.35     69    70.88  46400431 69.97789
[1] -0.04915365
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-13   71.29   71.35  68.15    68.83  57091157 71.24085
[1] -0.005275918
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-14   68.49   69.43  67.46    67.72  48226824 68.48472
[1] -0.2435772
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-17   68.18   68.95  66.62    68.74  52196699 67.93642
[1] 0.1473224
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-18   68.76    69.6   68.3    69.19  40827226 68.90732
[1] -0.1646254
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-19   69.17   69.29  67.46    68.24  43980558 69.00537
[1] 0.09672474
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-20   68.01   68.23  66.82    66.97  44438500 68.10672
[1] -0.1492383
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-21   67.53   67.92  66.18    67.24  60041228 67.38076
[1] 0.08145292
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-24   67.19   67.36  63.36     64.1  85695872 67.27145
[1] -0.2479828
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-25   64.89   66.19  63.78    64.89  68785500 64.64202
[1] -0.1015437
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-26   64.74   64.95  60.37    60.38  97689774 64.63846
[1] -0.104172
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-27   60.51    61.9  57.98    60.97 112649694 60.40583
[1] -0.01013949
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-28   61.34   61.95  59.34    60.01  67051528 61.32986
[1] -0.3485784
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-03-31   60.78   61.52  59.87    60.24  53011205 60.43142
[1] -0.08964198
           FB.Open FB.High FB.Low FB.Close FB.Volume     Pred
2014-04-01   60.46   62.66  60.24    62.62  59291210 60.37036
> 
> print(paste0("[Stat] Rows = ", rows))
[1] "[Stat] Rows = 253"
> #print(rows)
> 
> MAPE <- MAPEsum*100/rows
> sprintf("[Stat] MAPE = %s\n", MAPE)
[1] "[Stat] MAPE = 1.63578782678042\n"
> #cat("[Stat] MAPE = ", MAPE)
> #print(MAPE)
> 
> actuals <- testset$FB.Close
> ymax = max (actuals)
> ymin = min (actuals)
> NRMSE <- sqrt(NRMSEsum)/(rows * (ymax - ymin))
> print(paste0("[Stat] NRMSE = ", NRMSE))
[1] "[Stat] NRMSE = 0.00133284451833936"
> #cat("NRMSE = ", NRMSE)
> #print(NRMSE)
> 
> # plot actual with predicted values added
> # compare actual closing value and predicted closing value
> #chartSeries(testset[2:rows, 4], theme='white', col = 'green', name = "FB", legend = "Actual",
> chartSeries(testset[1:rows, 1], theme= chartTheme('white', up.col = 'blue'), name = "FB", legend = "Actual",
+ 	TA = "addTA(testset[1:rows, ncol(testset)], on = 1, col='red')") # 
> #chartSeries(testset[2:rows, 1], theme='white.mono', name = 'Actual', TA = "addTA(testset[2:rows, 7], on = 1, col='yellow', legend = \"Predicted\")") # 
> #chartSeries(testset[, 1], name = 'Actual', TA = "addTA(testset[, 7], on = 1, col='blue', legend = \"Predicted\")") # 
> #chartSeries(testset)
> 
> 
> proc.time()
   user  system elapsed 
 25.893   0.059  26.117 
