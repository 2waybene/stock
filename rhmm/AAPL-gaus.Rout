
R version 3.0.2 (2013-09-25) -- "Frisbee Sailing"
Copyright (C) 2013 The R Foundation for Statistical Computing
Platform: x86_64-redhat-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> require(devEMF)
Loading required package: devEMF
> library(quantmod)
Loading required package: Defaults
Loading required package: xts
Loading required package: zoo

Attaching package: ‘zoo’

The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric

Loading required package: TTR
Version 0.4-0 included new data defaults. See ?getSymbols.
> library(RHmm)
Loading required package: MASS
Loading required package: nlme
> #postscript('AAPL-gaus.eps')
> 
> getSymbols("AAPL")
    As of 0.4-0, ‘getSymbols’ uses env=parent.frame() and
 auto.assign=TRUE by default.

 This  behavior  will be  phased out in 0.5-0  when the call  will
 default to use auto.assign=FALSE. getOption("getSymbols.env") and 
 getOptions("getSymbols.auto.assign") are now checked for alternate defaults

 This message is shown once per session and may be disabled by setting 
 options("getSymbols.warning4.0"=FALSE). See ?getSymbol for more details
[1] "AAPL"
> chartSeries(AAPL, theme="white")
> trainset <- window(AAPL, start = as.Date("2000-01-01"), end = as.Date("2013-04-01"))
> #print(trainset)
> #AAPL_Subset <- window(AAPL, start = as.Date("2000-01-01"), end = as.Date("2013-04-01"))
> #AAPL_Train <- cbind(AAPL_Subset$AAPL.Close - AAPL_Subset$AAPL.Open, AAPL_Subset$AAPL.Volume)
> train <- cbind(trainset$AAPL.Close - trainset$AAPL.Open)
> #print(train)
> 
> testset <- window(AAPL, start = as.Date("2013-04-01"), end = as.Date("2014-04-01"))
> test <- cbind(testset$AAPL.Close - testset$AAPL.Open)
> #print(testset)
> 
> # Baum-Welch Algorithm to find the model for the given observations
> #hm_model <- HMMFit(obs = AAPL_Train, nStates = 5)
> hm_model <- HMMFit(obs = train, nStates = 5, nMixt = 4, dis = "MIXTURE")
> 
> # Viterbi Algorithm to find the most probable state sequence
> VitPath <- viterbi (hm_model, train)
> 
> # scatter plot
> postscript('AAPL-gaus.eps')
> AAPL_Predict <- cbind(trainset$AAPL.Close, VitPath$states)
> #AAPL_Predict <- cbind(AAPL_Subset$AAPL.Close, VitPath$states)
> #print(AAPL_Subset[,4] - AAPL_Predict [,1])
> 
> # predict next stock value m = nMixt, n = nStates
> #sum(a[last(v),] * .colSums((matrix(unlist(a), nrow=4,ncol=5)) * (matrix(unlist(a), nrow=4,ncol=5)), m=4,n=5))
> # gaussian mixture HMM: nrow = nMixture, ncol = nStates
> #print(hm_model$HMM$transMat[last(VitPath$states),])
> #print(hm_model$HMM$distribution)
> #print(hm_model$HMM$distribution$mean)
> #print(hm_model$HMM$distribution$mean[, seq(1, ncol(hm_model$HMM$distribution$mean), by = 2)])
> #print(unlist(hm_model$HMM$distribution$mean))
> #print(matrix(unlist(hm_model$HMM$distribution$proportion[1,])))
> 
> # add a new colum "Pred"
> testset <- cbind(testset, Pred = 0)
> #testset <- cbind(testset$AAPL.Close, Pred = 0)
> #print(testset)
> 
> #chartSeries(testset, theme="white")
> #chartSeries(test, theme="white")
> 
> # number of rows of test set data
> rows = nrow(testset)
> 
> # predict and update HMM to include the new actual value
> #for (i in 1: 251) {
> for (i in 0: rows) {
+ #	print(i)
+ #	print(rows)
+ 	if (i == rows) break
+ 
+ 	if(i != 0) {
+ 		testrow <- testset[i, ]
+ 		print(testrow)
+ 		testopen <- testset$AAPL.Open[i, ]
+ 		testclose <- testset$AAPL.Close[i, ]
+ 	}
+ 
+ #	actual <- testset$AAPL.Open[i + 1, ]
+ 	#print(testset$AAPL.Open[i, ])
+ 
+ 	# predict 
+ 	change <- sum(hm_model$HMM$transMat[last(VitPath$states),] * .colSums((matrix(unlist(hm_model$HMM$distribution$mean), nrow=4,ncol=5)) * (matrix(unlist(hm_model$HMM$distribution$proportion), nrow=4,ncol=5)), m=4,n=5))
+ 	#sum(hm_model$HMM$transMat[last(VitPath$states),] * .colSums((matrix(unlist(hm_model$HMM$distribution$mean[1,]), nrow=4,ncol=5)) * (matrix(unlist(hm_model$HMM$distribution$proportion[1,]), nrow=4,ncol=5)), m=4,n=5))
+ 	print(change)
+ 
+ 	pred <- testclose + change
+ 	#pred <- (tail(AAPL_Subset$AAPL.Close) + change)
+ 	#testrow$Pred <- pred
+ 	#print(pred)
+ 	# update tomorrow's predicted value
+ 	testset[i + 1, ]$Pred <- pred
+ 	#print(testset[i + 1, ]$Pred)
+ 
+ 	# MAPE = sum(|pred - actual|/|actual|)*100/n
+ 	#MAPE <- pred$AAPL.Close - actual$AAPL.Close
+ 	#MAPE <- abs((pred$AAPL.Close - actual$AAPL.Close)/actual$AAPL.Close)
+ 	#MAPE <- abs((pred$AAPL.Close - 420.05)/420.05) * 100
+ 	#print(MAPE)
+ 
+ 	# NRMSE = sqrt(sum((pred - actual)^2) / n)
+ 
+ 	# [Optional] Returns: sell or buy
+ 	# if stock increased sell, otherwise buy
+ 
+ 	# single HMM
+ 	#sum(hm_model$HMM$transMat[last(VitPath$states),] * .colSums((matrix(unlist(hm_model$HMM$distribution$mean), nrow=1,ncol=5)) * (matrix(unlist(hm_model$HMM$distribution$proportion), nrow=1,ncol=5)), m=1,n=5))
+ 
+ 	# Forward-backward 
+ 	#fb <- forwardBackward(hm_model, test, FALSE)
+ 	#print(fb)
+ 	#print(AAPL_Subset[,4] - AAPL_Predict [,1])
+ 
+ 	# update HMM with the new data
+ 	# Baum-Welch Algorithm to find the model for the given observations
+ 	#hm_model <- HMMFit(obs = train, nStates = 5, nMixt = 4, dis = "MIXTURE")
+ 
+ 	# Viterbi Algorithm to find the most probable state sequence
+ 	#VitPath <- viterbi (hm_model, train)
+ 
+ }
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-01     441.9     443.7   427.74     428.91    13919000        418.33
               Pred
2013-04-01 534.5431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-02     427.6    438.14    426.4     429.79    18911400        419.19
               Pred
2013-04-02 426.7131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-03    431.37    437.28   430.31     431.99    12972000        421.34
               Pred
2013-04-03 427.5931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-04    433.76       435   425.25     427.72    12801700        417.17
               Pred
2013-04-04 429.7931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-05     424.5    424.95   419.68      423.2    13703400        412.76
               Pred
2013-04-05 425.5231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-08    424.85     427.5   422.49     426.21    10743900         415.7
               Pred
2013-04-08 421.0031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-09    426.36     428.5   422.75     426.98    10950500        416.45
               Pred
2013-04-09 424.0131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-10     428.1    437.06   426.01     435.69    13426000        424.95
               Pred
2013-04-10 424.7831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-11    433.72    437.99    431.2     434.33    11727300        423.62
               Pred
2013-04-11 433.4931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-12    434.15    434.15   429.09      429.8     8521900         419.2
               Pred
2013-04-12 432.1331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-15       427    427.89   419.55     419.85    11340000         409.5
               Pred
2013-04-15 427.6031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-16    421.57    426.61   420.57     426.24    10920400        415.73
               Pred
2013-04-16 417.6531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-17    420.27     420.6   398.11      402.8    33752000        392.87
               Pred
2013-04-17 424.0431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-18    404.99    405.79   389.74     392.05    23796400        382.38
               Pred
2013-04-18 400.6031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-19    387.97     399.6    385.1     390.53    21759800         380.9
               Pred
2013-04-19 389.8531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-22    392.64     402.2   391.27     398.67    15354300        388.84
               Pred
2013-04-22 388.3331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-23    403.99    408.38   398.81     406.13    23722800        396.12
               Pred
2013-04-23 396.4731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-24    393.54    415.25    392.5     405.46    34630400        395.46
               Pred
2013-04-24 403.9331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-25    411.23    413.94      407     408.38    13744200        398.31
               Pred
2013-04-25 403.2631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-26    409.81    418.77   408.25      417.2    27289200        406.91
               Pred
2013-04-26 406.1831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-29    420.45    433.62      420     430.12    22868800        419.51
               Pred
2013-04-29 415.0031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-04-30     435.1    445.25   432.07     442.78    24697800        431.86
               Pred
2013-04-30 427.9231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-01    444.46    444.93   434.39     439.29    18103900        428.46
               Pred
2013-05-01 440.5831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-02    441.78    448.59   440.63     445.52    15065300        434.53
               Pred
2013-05-02 437.0931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-03    451.31    453.23   449.15     449.98    12903600        438.88
               Pred
2013-05-03 443.3231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-06    455.71     462.2   454.31     460.71    17737200        449.35
               Pred
2013-05-06 447.7831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-07    464.97    465.75    453.7     458.66    17276900        447.35
               Pred
2013-05-07 458.5131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-08    459.04    465.37   455.81     463.84    16878500         452.4
               Pred
2013-05-08 456.4631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-09    459.81       463   455.58     456.77    14231700        448.46
               Pred
2013-05-09 461.6431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-10    457.97    459.71   450.48     452.97    11959000        444.72
               Pred
2013-05-10 454.5731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-13    451.51     457.9    451.5     454.74    11319600        446.46
               Pred
2013-05-13 450.7731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-14    453.85     455.2   442.15     443.86    15968500        435.78
               Pred
2013-05-14 452.5431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-15    439.16       441   422.36     428.85    26486200        421.04
               Pred
2013-05-15 441.6631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-16    423.24    437.85    418.9     434.58    21543000        426.67
               Pred
2013-05-16 426.6531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-17    439.05    440.09   431.01     433.26    15282300        425.37
               Pred
2013-05-17 432.3831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-20    431.91     445.8    430.1     442.93    16127800        434.87
               Pred
2013-05-20 431.0631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-21    438.15    445.48    434.2     439.66    16286500        431.66
               Pred
2013-05-21 440.7331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-22    444.05    448.35   438.22     441.35    15822800        433.32
               Pred
2013-05-22 437.4631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-23    435.95    446.16   435.79     442.14    12607900        434.09
               Pred
2013-05-23 439.1531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-24    440.85    445.66   440.36     445.15     9863100        437.05
               Pred
2013-05-24 439.9431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-28     449.9    451.11   440.85     441.44    13790900         433.4
               Pred
2013-05-28 442.9531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-29       440     447.5    439.4     444.95    11806300        436.85
               Pred
2013-05-29 439.2431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-30    445.65     454.5   444.51     451.58    12625700        443.36
               Pred
2013-05-30 442.7531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-05-31     452.5     457.1    449.5     449.73    13725100        441.54
               Pred
2013-05-31 449.3831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-03    450.73    452.36   442.48     450.72    13298300        442.52
               Pred
2013-06-03 447.5331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-04    453.22    454.43   447.39     449.31    10454600        441.13
               Pred
2013-06-04 448.5231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-05    445.65    450.72   443.71     445.11    10378200        437.01
               Pred
2013-06-05 447.1131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-06    445.47       447   434.05     438.46    14890500        430.48
               Pred
2013-06-06 442.9131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-07     436.5    443.24   432.77     441.81    14447700        433.77
               Pred
2013-06-07 436.2631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-10    444.73    449.08    436.8     438.89    16076900         430.9
               Pred
2013-06-10 439.6131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-11    435.74    442.76   433.32      437.6    10218300        429.63
               Pred
2013-06-11 436.6931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-12     439.5    441.25    431.5     432.19     9472400        424.32
               Pred
2013-06-12 435.4031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-13     432.5    437.14   428.75     435.96    10208300        428.02
               Pred
2013-06-13 429.9931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-14     435.4    436.29    428.5     430.05     9709500        422.22
               Pred
2013-06-14 433.7631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-17    431.44     435.7   430.36        432     9264800        424.14
               Pred
2013-06-17 427.8531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-18    431.56     434.9   430.21     431.77     6965200        423.91
               Pred
2013-06-18 429.8031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-19     431.4    431.66      423        423    11105000         415.3
               Pred
2013-06-19 429.5731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-20     419.3    425.98   415.17     416.84    12761100        409.25
               Pred
2013-06-20 420.8031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-21    418.49       420    408.1      413.5    17182800        405.97
               Pred
2013-06-21 414.6431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-24     407.4    408.66   398.05     402.54    17169500        395.21
               Pred
2013-06-24 411.3031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-25     405.7    407.79   398.83     402.63    11220100         395.3
               Pred
2013-06-25 400.3431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-26     403.9    404.79   395.66     398.07    13133000        390.82
               Pred
2013-06-26 400.4331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-27    399.25    401.39   393.54     393.78    12044500        386.61
               Pred
2013-06-27 395.8731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-06-28    391.36    400.27   388.87     396.53    20661300        389.31
               Pred
2013-06-28 391.5831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-01    402.69    412.27   401.22     409.22    13966200        401.77
               Pred
2013-07-01 394.3331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-02    409.96    421.63   409.47     418.49    16780900        410.87
               Pred
2013-07-02 407.0231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-03    420.86    422.98   417.45      420.8     8604600        413.14
               Pred
2013-07-03 416.2931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-05    420.39    423.29   415.35     417.42     9786600        409.82
               Pred
2013-07-05 418.6031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-08    420.11       421   410.65     415.05    10647800        407.49
               Pred
2013-07-08 415.2231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-09     413.6     423.5   410.38     422.35    12592300        414.66
               Pred
2013-07-09 412.8531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-10     419.6     424.8   418.25     420.73    10050200        413.07
               Pred
2013-07-10 420.1531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-11    422.95    428.25   421.17     427.29    11653300        419.51
               Pred
2013-07-11 418.5331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-12    427.65    429.79   423.41     426.51     9984400        418.75
               Pred
2013-07-12 425.0931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-15    425.01    431.46    424.8     427.44     8639900        419.66
               Pred
2013-07-15 424.3131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-16    426.52    430.71   424.17      430.2     7733500        422.37
               Pred
2013-07-16 425.2431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-17     429.7    432.22   428.22     430.31     7106800        422.48
               Pred
2013-07-17 428.0031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-18    433.38    434.87   430.61     431.76     7817100         423.9
               Pred
2013-07-18 428.1131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-19     433.1    433.98   424.35     424.95     9597200        417.21
               Pred
2013-07-19 429.5631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-22    429.46    429.75   425.47     426.31     7421300        418.55
               Pred
2013-07-22 422.7531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-23       426    426.96   418.71     418.99    13192700        411.36
               Pred
2013-07-23 424.1131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-24    438.93    444.59   435.26     440.51    21140600        432.49
               Pred
2013-07-24 416.7931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-25     440.7     441.4   435.81      438.5     8196200        430.52
               Pred
2013-07-25 438.3131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-26     435.3    441.04   434.34     440.99     7148300        432.96
               Pred
2013-07-26 436.3031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-29     440.8    449.99    440.2     447.79     8859200        439.64
               Pred
2013-07-29 438.7931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-30    449.96    457.15   449.23     453.32    11050800        445.07
               Pred
2013-07-30 445.5931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-07-31    454.99    457.34   449.43     452.53    11534200        444.29
               Pred
2013-07-31 451.1231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-01    455.75     456.8   453.26     456.68     7366100        448.37
               Pred
2013-08-01 450.3331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-02    458.01    462.85   456.66     462.54     9813700        454.12
               Pred
2013-08-02 454.4831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-05    464.69    470.67   462.15     469.45    11387700         460.9
               Pred
2013-08-05 460.3431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-06    468.02    471.89   462.17     465.25    11959200        456.78
               Pred
2013-08-06 467.2531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-07     463.8       467   461.77     464.98    10673500        456.52
               Pred
2013-08-07 463.0531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-08    463.86     464.1   457.95     461.01     9134900        455.61
               Pred
2013-08-08 462.7831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-09    458.64    460.46   453.65     454.45     9530900        449.12
               Pred
2013-08-09 458.8131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-12    456.86    468.65   456.63     467.36    13015500        461.88
               Pred
2013-08-12 452.2531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-13    470.94    494.66   468.05     489.57    31497900        483.83
               Pred
2013-08-13 465.1631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-14    497.88    504.25    493.4      498.5    27013300        492.66
               Pred
2013-08-14 487.3731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-15    496.42     502.4   489.08     497.91    17510500        492.07
               Pred
2013-08-15 496.3031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-16    500.15    502.94   498.86     502.33    12939500        496.44
               Pred
2013-08-16 495.7131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-19    504.34    513.74      504     507.74    18232800        501.79
               Pred
2013-08-19 500.1331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-20    509.71    510.57   500.82     501.07    12810300         495.2
               Pred
2013-08-20 505.5431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-21    503.59    507.15    501.2     502.36    11995700        496.47
               Pred
2013-08-21 498.8731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-22    504.98    505.59    498.2     502.96     8721700        497.07
               Pred
2013-08-22 500.1631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-23    503.27    503.35   499.35     501.02     7954700        495.15
               Pred
2013-08-23 500.7631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-26    500.75     510.2    500.5     502.97    11820200        497.08
               Pred
2013-08-26 498.8231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-27       498    502.51    486.3     488.59    15149600        482.86
               Pred
2013-08-27 500.7731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-28       486     495.8      486      490.9    10986000        485.15
               Pred
2013-08-28 486.3931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-29    491.65     496.5   491.13      491.7     8559200        485.94
               Pred
2013-08-29 488.7031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-08-30       492    492.95    486.5     487.22     9724900        481.51
               Pred
2013-08-30 489.5031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-03     493.1     500.6   487.35     488.58    11854600        482.85
               Pred
2013-09-03 485.0231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-04    499.56    502.24   496.28     498.69    12322600        492.85
               Pred
2013-09-04 486.3831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-05    500.25    500.68   493.64     495.27     8441700        489.47
               Pred
2013-09-05 496.4931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-06    498.44    499.38   489.95     498.22    12840200        492.38
               Pred
2013-09-06 493.0731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-09       505    507.92   503.48     506.17    12167400        500.24
               Pred
2013-09-09 496.0231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-10     506.2    507.45    489.5     494.64    26542700        488.84
               Pred
2013-09-10 503.9731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-11    467.01    473.69   464.81     467.71    32096300        462.23
               Pred
2013-09-11 492.4431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-12     468.5     475.4   466.01     472.69    14430400        467.15
               Pred
2013-09-12 465.5131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-13    469.34    471.83    464.7      464.9    10672700        459.45
               Pred
2013-09-13 470.4931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-16       461    461.61   447.22     450.12    19418100        444.84
               Pred
2013-09-16 462.7031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-17    447.96    459.71    447.5     455.32    14263600        449.98
               Pred
2013-09-17 447.9231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-18    463.18    466.35   460.66     464.68    16316500        459.23
               Pred
2013-09-18 453.1231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-19     470.7    475.83   469.25      472.3    14447900        466.76
               Pred
2013-09-19 462.4831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-20       478    478.55      466     467.41    24975100        461.93
               Pred
2013-09-20 470.1031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-23     496.1    496.91    482.6     490.64    27218100        484.89
               Pred
2013-09-23 465.2131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-24    494.88    495.47   487.82      489.1    13012300        483.37
               Pred
2013-09-24 488.4431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-25     489.2    489.64   481.43     481.53    11319900        475.89
               Pred
2013-09-25 486.9031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-26       486    488.56    483.9     486.22     8472200        480.52
               Pred
2013-09-26 479.3331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-27    483.78    484.67   480.72     482.75     8144300        477.09
               Pred
2013-09-27 484.0231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-09-30    477.25    481.66   474.41     476.75     9291300        471.16
               Pred
2013-09-30 480.5531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-01    478.45    489.14   478.38     487.96    12638700        482.24
               Pred
2013-10-01 474.5531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-02    485.63     491.8   483.75     489.56    10328000        483.82
               Pred
2013-10-02 485.7631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-03    490.51    492.35   480.74     483.41    11526900        477.74
               Pred
2013-10-03 487.3631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-04    483.86     484.6    478.6     483.03     9245300        477.37
               Pred
2013-10-04 481.2131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-07    486.56    492.65   485.35     487.75    11153300        482.03
               Pred
2013-10-07 480.8331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-08    489.94    490.64   480.54     480.94    10389900         475.3
               Pred
2013-10-08 485.5531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-09    484.64    487.79   478.28     486.59    10775900        480.89
               Pred
2013-10-09 478.7431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-10    491.32    492.38   487.04     489.64     9950100         483.9
               Pred
2013-10-10 484.3931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-11    486.99    493.84   485.16     492.81     9562100        487.03
               Pred
2013-10-11 487.4431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-14    489.83    497.58   489.35     496.04     9353500        490.23
               Pred
2013-10-14 490.6131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-15    497.51       502   495.52     498.68    11431200        492.84
               Pred
2013-10-15 493.8431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-16    500.79    502.53   499.23     501.11     8967900        495.24
               Pred
2013-10-16 496.4831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-17    499.98    504.78   499.68      504.5     9056900        498.59
               Pred
2013-10-17 498.9131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-18    505.99    509.26   505.71     508.89    10376500        502.93
               Pred
2013-10-18 502.3031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-21    511.77     524.3   511.52     521.36    14218100        515.25
               Pred
2013-10-21 506.6931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-22    526.41    528.45   508.03     519.87    19073700        513.78
               Pred
2013-10-22 519.1631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-23       519    525.67      519     524.96    11204400        518.81
               Pred
2013-10-23 517.6731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-24       525    532.47   522.45     531.91    13741600        525.68
               Pred
2013-10-24 522.7631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-25    531.32    533.23   525.11     525.96    12064000         519.8
               Pred
2013-10-25 529.7131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-28    529.04       531   523.21     529.88    19658600        523.67
               Pred
2013-10-28 523.7631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-29    536.27    539.25   514.54     516.68    22707400        510.62
               Pred
2013-10-29 527.6831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-30    519.61    527.52   517.02      524.9    12648700        518.75
               Pred
2013-10-30 514.4831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-10-31       525    527.49   521.27      522.7     9846300        516.57
               Pred
2013-10-31 522.7031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-01    524.02     524.8   515.84     520.03     9817500        513.94
               Pred
2013-11-01 520.5031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-04     521.1    526.82   518.81     526.75     8736700        520.58
               Pred
2013-11-04 517.8331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-05    524.58    528.89      523     525.45     9471900        519.29
               Pred
2013-11-05 524.5531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-06    524.15    524.86    518.2     520.92     7977700        517.82
               Pred
2013-11-06 523.2531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-07    519.58    523.19   512.38     512.49     9379300        509.44
               Pred
2013-11-07 518.7231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-08    514.58    521.13   512.59     520.56     9975600        517.46
               Pred
2013-11-08 510.2931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-11    519.99    521.67   514.41     519.05     8123300        515.96
               Pred
2013-11-11 518.3631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-12    517.67    523.92      517     520.01     7295600        516.92
               Pred
2013-11-12 516.8531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-13       518    522.25   516.96     520.63     7043600        517.53
               Pred
2013-11-13 517.8131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-14    522.81    529.28   521.87     528.16    10086400        525.02
               Pred
2013-11-14 518.4331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-15    526.58    529.09   524.49     524.99    11354300        521.87
               Pred
2013-11-15 525.9631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-18    524.99    527.19    518.2     518.63     8748000        515.54
               Pred
2013-11-18 522.7931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-19    519.03    523.38   517.97     519.55     7462100        516.46
               Pred
2013-11-19 516.4331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-20    519.23    520.42   514.33        515     6925600        511.94
               Pred
2013-11-20 517.3531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-21     517.6    521.21   513.67     521.14     9358100        518.04
               Pred
2013-11-21 512.8031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-22    519.52    522.16   518.53      519.8     7990200        516.71
               Pred
2013-11-22 518.9431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-25    521.02    525.87      521     523.74     8189700        520.62
               Pred
2013-11-25 517.6031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-26    524.12    536.14      524      533.4    14335100        530.23
               Pred
2013-11-26 521.5431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-27    536.31       546    533.4     545.96    12980300        542.71
               Pred
2013-11-27 531.2031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-11-29    549.48    558.33   547.81     556.07    11361700        552.76
               Pred
2013-11-29 543.7631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-02       558    564.33   550.82     551.23    16876600        547.95
               Pred
2013-12-02 553.8731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-03     558.3    566.38   557.68     566.32    16106000        562.95
               Pred
2013-12-03 549.0331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-04     565.5    569.19   560.82        565    13493200        561.64
               Pred
2013-12-04 564.1231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-05    572.65    575.14   566.41      567.9    15985000        564.52
               Pred
2013-12-05 562.8031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-06    565.79    566.75   559.57     560.02    12298300        556.69
               Pred
2013-12-06 565.7031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-09     560.9    569.58    560.9     566.43    11446200        563.06
               Pred
2013-12-09 557.8231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-10    563.58    567.88    561.2     565.55     9938200        562.18
               Pred
2013-12-10 564.2331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-11       567    570.97   559.69     561.36    12847100        558.02
               Pred
2013-12-11 563.3531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-12    562.14    565.34   560.03     560.54     9367500         557.2
               Pred
2013-12-12 559.1631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-13    562.85    562.88   553.67     554.43    11886500        551.13
               Pred
2013-12-13 558.3431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-16    555.02    562.64   555.01      557.5    10092600        554.18
               Pred
2013-12-16 552.2331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-17    555.81    559.44   553.38     554.99     8210800        551.69
               Pred
2013-12-17 555.3031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-18     549.7    551.45    538.8     550.77    20209400        547.49
               Pred
2013-12-18 552.7931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-19     549.5       550   543.73     544.46    11439600        541.22
               Pred
2013-12-19 548.5731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-20    545.43    551.61   544.82     549.02    15586200        545.75
               Pred
2013-12-20 542.2631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-23       568    570.72   562.76     570.09    17903800         566.7
               Pred
2013-12-23 546.8231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-24    569.89    571.88   566.03     567.67     5984100        564.29
               Pred
2013-12-24 567.8931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-26     568.1     569.5   563.38      563.9     7286000        560.54
               Pred
2013-12-26 565.4731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-27    563.82    564.41    559.5     560.09     8067300        556.76
               Pred
2013-12-27 561.7031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-30    557.46    560.09   552.32     554.52     9058200        551.22
               Pred
2013-12-30 557.8931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2013-12-31    554.17    561.28      554     561.02     7967300        557.68
               Pred
2013-12-31 552.3231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-02    555.68    557.03   552.02     553.13     8381600        549.84
               Pred
2014-01-02 558.8231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-03    552.86     553.7   540.43     540.98    14016700        537.76
               Pred
2014-01-03 550.9331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-06    537.45     546.8    533.6     543.93    14736100        540.69
               Pred
2014-01-06 538.7831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-07    544.32    545.96   537.92     540.04    11328900        536.83
               Pred
2014-01-07 541.7331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-08    538.81    545.56   538.69     543.46     9233200        540.23
               Pred
2014-01-08 537.8431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-09     546.8    546.86   535.35     536.52     9969600        533.33
               Pred
2014-01-09 541.2631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-10    539.83     540.8   531.11     532.94    10892000        529.77
               Pred
2014-01-10 534.3231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-13    529.91     542.5   529.88     535.73    13517600        532.54
               Pred
2014-01-13 530.7431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-14    538.22    546.73   537.66     546.39    11877200        543.14
               Pred
2014-01-14 533.5331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-15    553.52     560.2   551.66     557.36    13987100        554.04
               Pred
2014-01-15 544.1931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-16     554.9    556.85   551.68     554.25     8188500        550.95
               Pred
2014-01-16 555.1631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-17    551.48    552.07    539.9     540.67    15240700        537.45
               Pred
2014-01-17 552.0531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-21    540.99    550.07   540.42     549.07    11733100         545.8
               Pred
2014-01-21 538.4731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-22    550.91    557.29   547.81     551.51    13570900        548.23
               Pred
2014-01-22 546.8731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-23    549.94     556.5   544.81     556.18    14401400        552.87
               Pred
2014-01-23 549.3131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-24       554    555.62   544.75     546.07    15334100        542.82
               Pred
2014-01-24 553.9831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-27    550.07     554.8   545.75      550.5    19817100        547.22
               Pred
2014-01-27 543.8731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-28    508.76       515   502.07      506.5    38054400        503.49
               Pred
2014-01-28 548.3031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-29    503.95    507.37   498.62     500.75    17957500        497.77
               Pred
2014-01-29 504.3031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-30    502.54     506.5    496.7     499.78    24232200        496.81
               Pred
2014-01-30 498.5531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-01-31    495.18    501.53   493.55      500.6    16599900        497.62
               Pred
2014-01-31 497.5831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-03    502.61    507.73    499.3     501.53    14338000        498.55
               Pred
2014-02-03 498.4031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-04    505.85    509.46   502.76     508.79    13452900        505.76
               Pred
2014-02-04 499.3331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-05    506.56    515.28   506.25     512.59    11726600        509.54
               Pred
2014-02-05 506.5931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-06    510.06     513.5   507.81     512.51     9205900        512.51
               Pred
2014-02-06 510.3931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-07    521.38    522.93   517.38     519.68    13224300        519.68
               Pred
2014-02-07 510.3131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-10    518.66    531.99      518     528.99    12341400        528.99
               Pred
2014-02-10 517.4831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-11    530.61    537.75    529.5     535.96    10080600        535.96
               Pred
2014-02-11 526.7931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-12    536.95    539.56   533.24     535.92    11003600        535.92
               Pred
2014-02-12 533.7631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-13    534.66    544.85    534.2     544.43    10978500        544.43
               Pred
2014-02-13 533.7231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-14    542.47    545.98   541.21     543.99     9747300        543.99
               Pred
2014-02-14 542.2331
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-18       546    551.19   545.61     545.99     9294700        545.99
               Pred
2014-02-18 541.7931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-19    544.75    546.89   534.35     537.37    11206000        537.37
               Pred
2014-02-19 543.7931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-20    532.99       537      529     531.15    10923500        531.15
               Pred
2014-02-20 535.1731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-21    532.79    534.57    524.6     525.25     9956600        525.25
               Pred
2014-02-21 528.9531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-24    523.15    529.92   522.42     527.55    10318200        527.55
               Pred
2014-02-24 523.0531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-25    529.38    529.57      521     522.06     8284000        522.06
               Pred
2014-02-25 525.3531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-26    523.61       525    515.6     517.35     9864900        517.35
               Pred
2014-02-26 519.8631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-27    517.14    528.78   516.05     527.67    10781500        527.67
               Pred
2014-02-27 515.1531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-02-28    529.08    532.75   522.12     526.24    13284600        526.24
               Pred
2014-02-28 525.4731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-03    523.42    530.65   522.81     527.76     8527900        527.76
               Pred
2014-03-03 524.0431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-04       531    532.64   527.77     531.24     9255000        531.24
               Pred
2014-03-04 525.5631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-05    530.92    534.75   529.13     532.36     7145100        532.36
               Pred
2014-03-05 529.0431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-06    532.79    534.44    528.1     530.75     6624600        530.75
               Pred
2014-03-06 530.1631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-07    531.09    531.98   526.05     530.44     7883200        530.44
               Pred
2014-03-07 528.5531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-10    528.36    533.33   528.34     530.92     6378000        530.92
               Pred
2014-03-10 528.2431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-11    535.45    538.74   532.59     536.09     9972300        536.09
               Pred
2014-03-11 528.7231
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-12    534.51    537.35      532     536.61     7118800        536.61
               Pred
2014-03-12 533.8931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-13    537.44    539.66   529.16     530.65     9205100        530.65
               Pred
2014-03-13 534.4131
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-14    528.79    530.89      523     524.69     8471400        524.69
               Pred
2014-03-14 528.4531
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-17     527.7    529.97   525.85     526.74     7126600        526.74
               Pred
2014-03-17 522.4931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-18     525.9    531.97    525.2      531.4     7487400         531.4
               Pred
2014-03-18 524.5431
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-19    532.26    536.24      529     531.26     8027000        531.26
               Pred
2014-03-19 529.2031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-20    529.89    532.67   527.35      528.7     7442800         528.7
               Pred
2014-03-20 529.0631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-21    531.93    533.75   526.33     532.87    13358800        532.87
               Pred
2014-03-21 526.5031
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-24    538.42     540.5   535.06     539.19    12703600        539.19
               Pred
2014-03-24 530.6731
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-25     541.5    545.75   539.59     544.99    10081900        544.99
               Pred
2014-03-25 536.9931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-26    546.52       549   538.86     539.78    10706000        539.78
               Pred
2014-03-26 542.7931
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-27    540.02     541.5   535.12     537.46     7929700        537.46
               Pred
2014-03-27 537.5831
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-28    538.32    538.94   534.25     536.86     7163000        536.86
               Pred
2014-03-28 535.2631
[1] -2.196891
           AAPL.Open AAPL.High AAPL.Low AAPL.Close AAPL.Volume AAPL.Adjusted
2014-03-31    539.23    540.81   535.93     536.74     6023900        536.74
               Pred
2014-03-31 534.6631
[1] -2.196891
> 
> # plot actual with predicted values added
> #chartSeries(testset[2:rows, 1], theme='white', col = 'green', name = "AAPL", legend = "Actual",
> chartSeries(testset[2:rows, 1], theme= chartTheme('white', up.col = 'blue'), name = "AAPL", legend = "Actual",
+ 	TA = "addTA(testset[2:rows, 7], on = 1, col='red')") # 
> #chartSeries(testset[2:rows, 1], theme='white.mono', name = 'Actual', TA = "addTA(testset[2:rows, 7], on = 1, col='yellow', legend = \"Predicted\")") # 
> #chartSeries(testset[, 1], name = 'Actual', TA = "addTA(testset[, 7], on = 1, col='blue', legend = \"Predicted\")") # 
> #chartSeries(testset[, 1], TA = "addTA(testset[, 7], on = 1, col=26, legend = \"Predicted\")") # blue
> #chartSeries(testset[, 1], TA = "addTA(testset[, 7], on = 1, col=col2rgb("blue"), legend = \"Predicted\")") # 
> #chartSeries(testset[, 1], TA = "addTA(testset[, 7], on = 1, col=7, legend = \"Predicted\")") # yellow
> #chartSeries(testset[, 1], TA = "addTA(testset[, 7], on = 1, col=10)") # red
> #chartSeries(testset[, 1], TA = "addTA(testset[, 7], on = 1, col=8)") # grey?
> #chartSeries(testset[, 1], TA = "addTA(testset[, 7], on = 1, col=6)") # pink
> #chartSeries(testset[, 1], TA = "addTA(testset[, 7], on = 1, col=9)") # black
> 
> #chartSeries(testset)
> 
> #chartSeries(AAPL_Predict[,1], layout = layout(matrix(2:1)), # 1, 2, byrow = TRUE), #respect = TRUE), #theme="white.mono", 
> #TA="addTA(AAPL_Predict[AAPL_Predict[,2]==1,1], legend = \"one day?\", on=1, col=5,pch=25);
> #addTA(AAPL_Predict[AAPL_Predict[,2]==2,1],on=1,type='p',col=6,pch=24);
> #addTA(AAPL_Predict[AAPL_Predict[,2]==3,1],on=1,type='p',col=7,pch=23);
> #addTA(AAPL_Predict[AAPL_Predict[,2]==4,1],on=1,type='p',col=8,pch=22);
> #addTA(AAPL_Predict[AAPL_Predict[,2]==5,1],on=1,type='p',col=10,pch=21)
> #")
> 
> 
> proc.time()
   user  system elapsed 
  5.866   0.082   6.132 
